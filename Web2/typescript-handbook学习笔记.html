<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript Handbook笔记 | Lim&#39;s Page</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/zelda.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="192x192" href="/zelda-192.png">
    <meta name="description" content="something about front-end">
    
    <link rel="preload" href="/assets/css/0.styles.8de41c91.css" as="style"><link rel="preload" href="/assets/js/app.750feb0e.js" as="script"><link rel="preload" href="/assets/js/2.51f79b28.js" as="script"><link rel="preload" href="/assets/js/105.6a8045bd.js" as="script"><link rel="preload" href="/assets/js/10.c677f95a.js" as="script"><link rel="prefetch" href="/assets/js/100.177f514a.js"><link rel="prefetch" href="/assets/js/101.bd0c4e7f.js"><link rel="prefetch" href="/assets/js/102.cadfa153.js"><link rel="prefetch" href="/assets/js/103.2706f2ae.js"><link rel="prefetch" href="/assets/js/104.59af27a1.js"><link rel="prefetch" href="/assets/js/106.bd6e128c.js"><link rel="prefetch" href="/assets/js/107.e8ec64a4.js"><link rel="prefetch" href="/assets/js/108.48c5b40e.js"><link rel="prefetch" href="/assets/js/109.1f3ecd2d.js"><link rel="prefetch" href="/assets/js/11.da07f57e.js"><link rel="prefetch" href="/assets/js/110.59ab3d87.js"><link rel="prefetch" href="/assets/js/111.6e505792.js"><link rel="prefetch" href="/assets/js/112.6805675b.js"><link rel="prefetch" href="/assets/js/113.8351e89e.js"><link rel="prefetch" href="/assets/js/114.f8ae045e.js"><link rel="prefetch" href="/assets/js/12.e3689742.js"><link rel="prefetch" href="/assets/js/13.b519f9a3.js"><link rel="prefetch" href="/assets/js/14.53eebcd6.js"><link rel="prefetch" href="/assets/js/15.1d4304e2.js"><link rel="prefetch" href="/assets/js/16.949c7023.js"><link rel="prefetch" href="/assets/js/17.1ebb059b.js"><link rel="prefetch" href="/assets/js/18.70936c5f.js"><link rel="prefetch" href="/assets/js/19.60e280c9.js"><link rel="prefetch" href="/assets/js/20.acc3b53c.js"><link rel="prefetch" href="/assets/js/21.000f9bfe.js"><link rel="prefetch" href="/assets/js/22.dde14540.js"><link rel="prefetch" href="/assets/js/23.91dc37f8.js"><link rel="prefetch" href="/assets/js/24.3356f787.js"><link rel="prefetch" href="/assets/js/25.5aad8683.js"><link rel="prefetch" href="/assets/js/26.147bad61.js"><link rel="prefetch" href="/assets/js/27.d6e6818f.js"><link rel="prefetch" href="/assets/js/28.89264090.js"><link rel="prefetch" href="/assets/js/29.6fa2b213.js"><link rel="prefetch" href="/assets/js/3.e7a2c18f.js"><link rel="prefetch" href="/assets/js/30.0d23825c.js"><link rel="prefetch" href="/assets/js/31.6a3ff0b7.js"><link rel="prefetch" href="/assets/js/32.ee5614c3.js"><link rel="prefetch" href="/assets/js/33.8b077b7f.js"><link rel="prefetch" href="/assets/js/34.2d88a808.js"><link rel="prefetch" href="/assets/js/35.f1eb02ae.js"><link rel="prefetch" href="/assets/js/36.77d7adb2.js"><link rel="prefetch" href="/assets/js/37.6775800c.js"><link rel="prefetch" href="/assets/js/38.fdd1253f.js"><link rel="prefetch" href="/assets/js/39.c62e28db.js"><link rel="prefetch" href="/assets/js/4.6c56feef.js"><link rel="prefetch" href="/assets/js/40.9054f4e2.js"><link rel="prefetch" href="/assets/js/41.e7b94d57.js"><link rel="prefetch" href="/assets/js/42.b1786a78.js"><link rel="prefetch" href="/assets/js/43.1580e7b7.js"><link rel="prefetch" href="/assets/js/44.65ed8576.js"><link rel="prefetch" href="/assets/js/45.36712ec7.js"><link rel="prefetch" href="/assets/js/46.1ccea627.js"><link rel="prefetch" href="/assets/js/47.13942b71.js"><link rel="prefetch" href="/assets/js/48.19830dcb.js"><link rel="prefetch" href="/assets/js/49.09aa6295.js"><link rel="prefetch" href="/assets/js/5.d17b0055.js"><link rel="prefetch" href="/assets/js/50.df95e7c1.js"><link rel="prefetch" href="/assets/js/51.beb07eea.js"><link rel="prefetch" href="/assets/js/52.f599e852.js"><link rel="prefetch" href="/assets/js/53.63bc005f.js"><link rel="prefetch" href="/assets/js/54.8fca02df.js"><link rel="prefetch" href="/assets/js/55.4add5831.js"><link rel="prefetch" href="/assets/js/56.e5bd1172.js"><link rel="prefetch" href="/assets/js/57.b0ef0d61.js"><link rel="prefetch" href="/assets/js/58.0a727eef.js"><link rel="prefetch" href="/assets/js/59.9bbd5c95.js"><link rel="prefetch" href="/assets/js/6.8308d385.js"><link rel="prefetch" href="/assets/js/60.c5256477.js"><link rel="prefetch" href="/assets/js/61.b2709925.js"><link rel="prefetch" href="/assets/js/62.7f88b67a.js"><link rel="prefetch" href="/assets/js/63.f45cc107.js"><link rel="prefetch" href="/assets/js/64.c2272af3.js"><link rel="prefetch" href="/assets/js/65.aa141d4c.js"><link rel="prefetch" href="/assets/js/66.1a0d0448.js"><link rel="prefetch" href="/assets/js/67.1f8281e9.js"><link rel="prefetch" href="/assets/js/68.4327c5c0.js"><link rel="prefetch" href="/assets/js/69.45c10907.js"><link rel="prefetch" href="/assets/js/7.25ac0485.js"><link rel="prefetch" href="/assets/js/70.3057e14c.js"><link rel="prefetch" href="/assets/js/71.5efe1e42.js"><link rel="prefetch" href="/assets/js/72.fc58a760.js"><link rel="prefetch" href="/assets/js/73.5d2dc328.js"><link rel="prefetch" href="/assets/js/74.08d8b949.js"><link rel="prefetch" href="/assets/js/75.f2bb48ad.js"><link rel="prefetch" href="/assets/js/76.96a4273b.js"><link rel="prefetch" href="/assets/js/77.d5877740.js"><link rel="prefetch" href="/assets/js/78.43c99cc0.js"><link rel="prefetch" href="/assets/js/79.bfce4a46.js"><link rel="prefetch" href="/assets/js/8.98216078.js"><link rel="prefetch" href="/assets/js/80.1a4d9abd.js"><link rel="prefetch" href="/assets/js/81.22561592.js"><link rel="prefetch" href="/assets/js/82.ba55ed12.js"><link rel="prefetch" href="/assets/js/83.97fdeadc.js"><link rel="prefetch" href="/assets/js/84.74bc54ee.js"><link rel="prefetch" href="/assets/js/85.86430dd5.js"><link rel="prefetch" href="/assets/js/86.746060ff.js"><link rel="prefetch" href="/assets/js/87.3a394a36.js"><link rel="prefetch" href="/assets/js/88.364afa36.js"><link rel="prefetch" href="/assets/js/89.b01f6f1b.js"><link rel="prefetch" href="/assets/js/9.2f45caf6.js"><link rel="prefetch" href="/assets/js/90.1b8e8891.js"><link rel="prefetch" href="/assets/js/91.1febf461.js"><link rel="prefetch" href="/assets/js/92.92378978.js"><link rel="prefetch" href="/assets/js/93.8fbfafa9.js"><link rel="prefetch" href="/assets/js/94.0cd4c971.js"><link rel="prefetch" href="/assets/js/95.7f7b8f77.js"><link rel="prefetch" href="/assets/js/96.87929228.js"><link rel="prefetch" href="/assets/js/97.87b1c656.js"><link rel="prefetch" href="/assets/js/98.eb84c7b1.js"><link rel="prefetch" href="/assets/js/99.b7d87337.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8de41c91.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Lim's Page</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/" class="nav-link">
  Web
</a></li><li class="dropdown-item"><!----> <a href="/Web2/" class="nav-link router-link-active">
  Web2
</a></li><li class="dropdown-item"><!----> <a href="/EnvironmentSetting/" class="nav-link">
  Environment Setting
</a></li><li class="dropdown-item"><!----> <a href="/Kubernetes/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/Sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/Redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Limsanity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/" class="nav-link">
  Web
</a></li><li class="dropdown-item"><!----> <a href="/Web2/" class="nav-link router-link-active">
  Web2
</a></li><li class="dropdown-item"><!----> <a href="/EnvironmentSetting/" class="nav-link">
  Environment Setting
</a></li><li class="dropdown-item"><!----> <a href="/Kubernetes/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/Sentry/" class="nav-link">
  Sentry
</a></li><li class="dropdown-item"><!----> <a href="/Redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Limsanity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TypeScript Handbook笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#basic-types" class="sidebar-link">Basic Types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#boolean" class="sidebar-link">Boolean</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#number" class="sidebar-link">Number</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#string" class="sidebar-link">String</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#array" class="sidebar-link">Array</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#tuple" class="sidebar-link">Tuple</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enum" class="sidebar-link">Enum</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#any" class="sidebar-link">Any</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#void" class="sidebar-link">Void</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#null-and-undefined" class="sidebar-link">Null and Undefined</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#never" class="sidebar-link">Never</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#object" class="sidebar-link">Object</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-assertions" class="sidebar-link">Type assertions</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#variable-declarations" class="sidebar-link">Variable Declarations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#let-declaration" class="sidebar-link">let declaration</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#destructuring" class="sidebar-link">Destructuring</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#interface" class="sidebar-link">Interface</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#readonly-properites" class="sidebar-link">Readonly properites</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#function-types" class="sidebar-link">Function Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#indexable-types" class="sidebar-link">Indexable Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#class-type" class="sidebar-link">Class Type</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#extending-interfaces" class="sidebar-link">Extending Interfaces</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#hybrid-types" class="sidebar-link">Hybrid Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#interfaces-extending-classes" class="sidebar-link">Interfaces Extending Classes</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#classes" class="sidebar-link">Classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#emascript-private-fields" class="sidebar-link">EMAScript Private Fields</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#understanding-typescript-s-private" class="sidebar-link">Understanding TypeScript's private</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#understanding-protected" class="sidebar-link">Understanding protected</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#readonly-modifier" class="sidebar-link">Readonly modifier</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#accessors" class="sidebar-link">Accessors</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#static-properties" class="sidebar-link">Static Properties</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#abstract-classes" class="sidebar-link">Abstract Classes</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#advanced-techniques" class="sidebar-link">Advanced Techniques</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#functions" class="sidebar-link">Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#thisparameters" class="sidebar-link">thisparameters</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#overloads" class="sidebar-link">Overloads</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generics" class="sidebar-link">Generics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generic-types" class="sidebar-link">Generic Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generic-classes" class="sidebar-link">Generic Classes</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generic-constraints" class="sidebar-link">Generic Constraints</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enums" class="sidebar-link">Enums</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#numeric-enums" class="sidebar-link">Numeric enums</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#string-enums" class="sidebar-link">String enums</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#computed-and-constant-members" class="sidebar-link">Computed and constant members</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enums-at-runtime" class="sidebar-link">Enums at runtime</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enums-at-compile-time" class="sidebar-link">Enums at compile time</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#reverse-mappings" class="sidebar-link">Reverse mappings</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#const-enums" class="sidebar-link">const enums</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#ambient-enums" class="sidebar-link">Ambient enums</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-inference" class="sidebar-link">Type Inference</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-compatibility" class="sidebar-link">Type Compatibility</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#starting-out" class="sidebar-link">Starting out</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#comparing-two-functions" class="sidebar-link">Comparing two functions</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#classes-2" class="sidebar-link">Classes</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generics-2" class="sidebar-link">Generics</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#advanced-types" class="sidebar-link">Advanced Types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#intersection-types" class="sidebar-link">Intersection Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#union-types" class="sidebar-link">Union Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-guards-and-differentiaing-types" class="sidebar-link">Type Guards and Differentiaing Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#user-defined-type-guards" class="sidebar-link">User-Defined Type Guards</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#typeof-type-guards" class="sidebar-link">typeof type guards</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#instanceof-type-guards" class="sidebar-link">instanceof type guards</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#nullable-types" class="sidebar-link">Nullable types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#optional-parameters-and-properties" class="sidebar-link">Optional parameters and properties</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-guards-and-type-assertions" class="sidebar-link">Type guards and type assertions</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-aliases" class="sidebar-link">Type Aliases</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#interfaces-vs-type-aliases" class="sidebar-link">Interfaces vs. Type Aliases</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#string-literal-types" class="sidebar-link">String Literal Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#numeric-literal-types" class="sidebar-link">Numeric Literal Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enum-member-types" class="sidebar-link">Enum Member Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#discriminated-unions" class="sidebar-link">Discriminated Unions</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#exhaustiveness-checking" class="sidebar-link">Exhaustiveness checking</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#polymorphic-this-types" class="sidebar-link">Polymorphic this types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#index-types" class="sidebar-link">Index types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#index-types-and-index-signatures" class="sidebar-link">Index types and index signatures</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#mapped-types" class="sidebar-link">Mapped types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#conditional-types" class="sidebar-link">Conditional Types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#distributive-conditional-types" class="sidebar-link">Distributive conditional types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#types-inference-in-conditional-types" class="sidebar-link">Types inference in conditional types</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#predefined-conditional-types" class="sidebar-link">Predefined conditional types</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#declaring-merging" class="sidebar-link">Declaring Merging</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#merging-interfaces" class="sidebar-link">Merging Interfaces</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#merging-namespaces" class="sidebar-link">Merging Namespaces</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#merging-namespaces-with-classes-functions-and-enums" class="sidebar-link">Merging Namespaces with Classes, Functions and Enums</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#disallowed-merges" class="sidebar-link">Disallowed Merges</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#module-augmentation" class="sidebar-link">Module Augmentation</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#global-augmentation" class="sidebar-link">Global Augmentation</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#decorators" class="sidebar-link">Decorators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#decorator-factories" class="sidebar-link">Decorator Factories</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#decorator-composition" class="sidebar-link">Decorator Composition</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#decorator-evaluation" class="sidebar-link">Decorator Evaluation</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#class-decorator" class="sidebar-link">Class Decorator</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#method-decorator" class="sidebar-link">Method Decorator</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#accessor-decorators" class="sidebar-link">Accessor Decorators</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#property-decorators" class="sidebar-link">Property Decorators</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#parameter-decorators" class="sidebar-link">Parameter Decorators</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#metadata" class="sidebar-link">Metadata</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#iterators-and-generators" class="sidebar-link">Iterators and Generators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#iterables" class="sidebar-link">Iterables</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#for-of-statements" class="sidebar-link">for..of statements</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#jsx" class="sidebar-link">JSX</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#basic-usage" class="sidebar-link">Basic usage</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#the-as-operator" class="sidebar-link">The as operator</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-checking" class="sidebar-link">Type Checking</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#intrinsic-elements" class="sidebar-link">Intrinsic elements</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#value-based-elements" class="sidebar-link">Value-based elements</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#attribute-type-checking" class="sidebar-link">Attribute type checking</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#children-type-checking" class="sidebar-link">Children Type Checking</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#the-jsx-result-type" class="sidebar-link">The JSX result type</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#embedding-expressions" class="sidebar-link">Embedding Expressions</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#react-integration" class="sidebar-link">React integration</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#factory-functions" class="sidebar-link">Factory Functions</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#mixins" class="sidebar-link">Mixins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#mixin-sample" class="sidebar-link">Mixin sample</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#understanding-the-sample" class="sidebar-link">Understanding the sample</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#modules" class="sidebar-link">Modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#export" class="sidebar-link">Export</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#import" class="sidebar-link">Import</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#default-exports" class="sidebar-link">Default exports</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#export-and-import-require" class="sidebar-link">export = and import = require()</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#code-generation-for-modules" class="sidebar-link">Code Generation for Modules</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#optional-module-loading-and-other-advanced-loading-scenarios" class="sidebar-link">Optional Module Loading and Other Advanced Loading Scenarios</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#working-with-other-js-libraries" class="sidebar-link">Working with Other JS Libraries</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#guidance-for-structuring-moduels" class="sidebar-link">Guidance for structuring moduels</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#re-export-to-extend" class="sidebar-link">Re-export to extend</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#do-not-use-namespaces-in-modules" class="sidebar-link">Do not use namespaces in modules</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#red-flags" class="sidebar-link">Red Flags</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#module-resolution" class="sidebar-link">Module Resolution</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#module-resolution-strategies" class="sidebar-link">Module Resolution Strategies</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#additional-module-resolution-flags" class="sidebar-link">Additional module resolution flags</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#tracing-module-resolution" class="sidebar-link">Tracing module resolution</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#using-noresolve" class="sidebar-link">Using --noResolve</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#common-question" class="sidebar-link">Common Question</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#namespaces" class="sidebar-link">Namespaces</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#namespaces-and-modules" class="sidebar-link">Namespaces and Modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#using-modules" class="sidebar-link">Using Modules</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#using-namespaces" class="sidebar-link">Using Namespaces</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#pitfalls-of-namespaces-and-modules" class="sidebar-link">Pitfalls of Namespaces and Modules</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#symbol" class="sidebar-link">Symbol</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#well-known-built-in-symbols" class="sidebar-link">Well-known Built-in Symbols</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#triple-slash-directives" class="sidebar-link">Triple-Slash Directives</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#reference-path" class="sidebar-link">/// \</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#reference-types" class="sidebar-link">/// \</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#reference-lib" class="sidebar-link">/// \</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#reference-no-default-lib-true" class="sidebar-link">/// \</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#amd-module" class="sidebar-link">/// \</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-compatibility-2" class="sidebar-link">Type Compatibility</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#introduction-2" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#a-note-on-soundess" class="sidebar-link">A Note on Soundess</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#starting-out-2" class="sidebar-link">Starting out</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#comparing-two-functions-2" class="sidebar-link">Comparing two functions</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#function-parameter-bivaraince" class="sidebar-link">Function Parameter Bivaraince</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#optional-parameters-and-rest-parameters-2" class="sidebar-link">Optional Parameters and Rest Parameters</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#functions-with-overloads-2" class="sidebar-link">Functions with overloads</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#enums-2" class="sidebar-link">Enums</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#classes-3" class="sidebar-link">Classes</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#private-and-protected-members-in-classes-2" class="sidebar-link">Private and protected members in classes</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#generics-3" class="sidebar-link">Generics</a></li></ul></li><li><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#type-inference-2" class="sidebar-link">Type Inference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#best-common-type" class="sidebar-link">Best common type</a></li><li class="sidebar-sub-header"><a href="/Web2/typescript-handbook%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html#contextual-typing" class="sidebar-link">Contextual Typing</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-handbook笔记"><a href="#typescript-handbook笔记" class="header-anchor">#</a> TypeScript Handbook笔记</h1> <h2 id="basic-types"><a href="#basic-types" class="header-anchor">#</a> Basic Types</h2> <h3 id="boolean"><a href="#boolean" class="header-anchor">#</a> Boolean</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> isDone<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="number"><a href="#number" class="header-anchor">#</a> Number</h3> <p>在TS中，所有数字都是浮点型。支持16进制、10进制、8进制、2进制。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> decimal<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> hex<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0xf00d</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> binary<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0b1010</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> octal<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0o744</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="string"><a href="#string" class="header-anchor">#</a> String</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> color<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="array"><a href="#array" class="header-anchor">#</a> Array</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一</span>
<span class="token keyword">let</span> list<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 方式二</span>
<span class="token keyword">let</span> list<span class="token operator">:</span> Array<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="tuple"><a href="#tuple" class="header-anchor">#</a> Tuple</h3> <p>元组中初始化需要和定义具有一致的类型顺序。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Declare a tuple type</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">,</span> number<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Initialize it</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

<span class="token comment">// Initialize it incorrectly</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><p>获取指定元素，其类型是确定的。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, 'number' does not have 'substring'</span>
</code></pre></div><p>超出元组范围会报错。</p> <div class="language-js extra-class"><pre class="language-js"><code>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span> <span class="token comment">// Error, Property '3' does not exist on type '[string, number]'.</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, Property '5' does not exist on type '[string, number]'</span>
</code></pre></div><h3 id="enum"><a href="#enum" class="header-anchor">#</a> Enum</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">enum</span> Color <span class="token punctuation">{</span>Red<span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">}</span>
<span class="token keyword">let</span> c<span class="token operator">:</span> Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>Green
</code></pre></div><p>枚举类型默认从<code>0</code>开始。也可以设置从别的值开始，例如从<code>1</code>开始：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">enum</span> Color <span class="token punctuation">{</span>Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">}</span>
<span class="token keyword">let</span> c<span class="token operator">:</span> Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>Green<span class="token punctuation">;</span>
</code></pre></div><p>也可以设置每个枚举元素对应的值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">enum</span> Color <span class="token punctuation">{</span>Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Green <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Blue <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> c<span class="token operator">:</span> Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>Green<span class="token punctuation">;</span>
</code></pre></div><p>枚举的其中一个特性是可以通过下标访问枚举元素对应的名字：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">enum</span> Color <span class="token punctuation">{</span>Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">}</span>
<span class="token keyword">let</span> colorName<span class="token operator">:</span> string <span class="token operator">=</span> Color<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colorName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Displays 'Green' as its value is 2 above</span>
</code></pre></div><h3 id="any"><a href="#any" class="header-anchor">#</a> Any</h3> <p><code>any</code>类型可以用于一些无法确定的变量，例如用户输入、第三方库。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> notSure<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
notSure <span class="token operator">=</span> <span class="token string">&quot;maybe a string instead&quot;</span><span class="token punctuation">;</span>
notSure <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// okay, definitely a boolean</span>
</code></pre></div><p><code>any</code>类型允许开发者渐进式地从js迁移到ts。</p> <p><code>Object</code>类型允许赋予任何值，但是无法调用其方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> notSure<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
notSure<span class="token punctuation">.</span><span class="token function">ifItExists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// okay, ifItExists might exist at runtime</span>
notSure<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// okay, toFixed exists (but the compiler doesn't check)</span>

<span class="token keyword">let</span> prettySure<span class="token operator">:</span> Object <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
prettySure<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: Property 'toFixed' doesn't exist on type 'Object'.</span>
</code></pre></div><p>如果变量为数组，但是其元素类型不一致，也可以使用<code>any</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> list<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;free&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="void"><a href="#void" class="header-anchor">#</a> Void</h3> <p><code>void</code>最常见于没有返回值的函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">warnUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;This is my warning message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果一个变量类型为<code>void</code>，只能赋予其<code>null</code>或者<code>undefined</code>，并且没有指定<code>--strictNullChecks</code>，否则会出现报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> unusable<span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
unusable <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// OK if `--strictNullChecks` is not given</span>
</code></pre></div><h3 id="null-and-undefined"><a href="#null-and-undefined" class="header-anchor">#</a> Null and Undefined</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Not much else we can assign to these variables!</span>
<span class="token keyword">let</span> u<span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> n<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>在TS中，<code>undefined</code>和<code>null</code>是两种类型。默认情况下，<code>null</code>和<code>undefined</code>是其他类型的子类型，意味着你可以为别的类型赋值<code>null</code>或<code>undefined</code>。</p> <p>如果开启了<code>--strictNullChecks</code>，<code>null</code>和<code>undefined</code>只可以赋值给其类型本身和<code>any</code>类型。如果一个变量可能为<code>string</code>、<code>null</code>、<code>undefined</code>，可以使用联合类型<code>string | null | undefined</code>。</p> <h3 id="never"><a href="#never" class="header-anchor">#</a> Never</h3> <p><code>never</code>主要用于抛出或返回错误的函数。</p> <p><code>never</code>是任何可赋值类型的子类型，但是任何可赋值类型的类型都不是<code>never</code>的子类型。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Function returning never must have unreachable end point</span>
<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> never <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Inferred return type is never</span>
<span class="token keyword">function</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Something failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Function returning never must have unreachable end point</span>
<span class="token keyword">function</span> <span class="token function">infiniteLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> never <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>never</code>也可以用于做一些详细的类型检查。示例请见<a href="https://www.zhihu.com/question/354601204" target="_blank" rel="noopener noreferrer">Typescript中never的作用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="object"><a href="#object" class="header-anchor">#</a> Object</h3> <p><code>object</code>类型用于表示非原始类型，即不是<code>number</code>、<code>string</code>、<code>boolean</code>、<code>bigint</code>、<code>symbol</code>、<code>null</code>、<code>undefined</code>。</p> <p>使用<code>object</code>类型，可以更好地表示一些类似<code>Object.create</code>类型的API，例如：</p> <div class="language-js extra-class"><pre class="language-js"><code>declare <span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">o<span class="token operator">:</span> object <span class="token operator">|</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

<span class="token function">create</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><h3 id="type-assertions"><a href="#type-assertions" class="header-anchor">#</a> Type assertions</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一</span>
<span class="token keyword">let</span> someValue<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> strLength<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>someValue<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

<span class="token comment">// 方式二</span>
<span class="token keyword">let</span> someValue<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> strLength<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span>someValue <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
</code></pre></div><p>如果使用JSX，那么需要使用方式二。</p> <h2 id="variable-declarations"><a href="#variable-declarations" class="header-anchor">#</a> Variable Declarations</h2> <h3 id="let-declaration"><a href="#let-declaration" class="header-anchor">#</a> <code>let</code> declaration</h3> <p><code>catch</code>语句括号中的变量拥有块级作用域。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">&quot;oh no!&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Oh well.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Error: 'e' doesn't exist here</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>函数中<code>let</code>声明不可和参数名一致（暂时性死区表现），但是函数内的诸如<code>if</code>块可以声明。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 示例一</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// error: interferes with parameter declaration</span>
<span class="token punctuation">}</span>

<span class="token comment">// 示例二</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">condition<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns '0'</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// returns '100'</span>
</code></pre></div><h3 id="destructuring"><a href="#destructuring" class="header-anchor">#</a> Destructuring</h3> <p>数组解构赋值可以忽略其中一些元素。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> second<span class="token punctuation">,</span> <span class="token punctuation">,</span> fourth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// outputs 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fourth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// outputs 4</span>
</code></pre></div><p>对象解构赋值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> <span class="token operator">...</span>passthrough <span class="token punctuation">}</span> <span class="token operator">=</span> o<span class="token punctuation">;</span>
<span class="token keyword">let</span> total <span class="token operator">=</span> passthrough<span class="token punctuation">.</span>b <span class="token operator">+</span> passthrough<span class="token punctuation">.</span>c<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
</code></pre></div><h2 id="interface"><a href="#interface" class="header-anchor">#</a> Interface</h2> <h3 id="readonly-properites"><a href="#readonly-properites" class="header-anchor">#</a> Readonly properites</h3> <p><code>ReadonlyArray&lt;T&gt;</code>类型的数组，无法调用变更式的方法，并且<code>ReadonlyArray</code>无法转换为<code>Array</code>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> ro<span class="token operator">:</span> ReadonlyArray<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
ro<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>
ro<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>
ro<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>
a <span class="token operator">=</span> ro<span class="token punctuation">;</span> <span class="token comment">// error!</span>
</code></pre></div><p>如果希望从<code>ReadonlyArray</code>转成<code>Array</code>，可以使用类型断言：</p> <div class="language-js extra-class"><pre class="language-js"><code>a <span class="token operator">=</span> ro <span class="token keyword">as</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><code>readonly</code>和<code>const</code>的区别就是，前者作用于属性，后者作用于变量。</p> <h3 id="function-types"><a href="#function-types" class="header-anchor">#</a> Function Types</h3> <p>函数类型接口和函数定义的参数名可以不一致：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">SearchFunc</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>source<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> subString<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> mySearch<span class="token operator">:</span> SearchFunc<span class="token punctuation">;</span>
<span class="token function-variable function">mySearch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> sub<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="indexable-types"><a href="#indexable-types" class="header-anchor">#</a> Indexable Types</h3> <p><code>number</code>索引签名返回类型，必须是<code>string</code>索引签名返回类型的子类型，因为使用<code>number</code>索引时，JS会将其转换成<code>string</code>，即：<code>a[100] -&gt; a[&quot;100&quot;]</code>，所以两者必须相容：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 示例一</span>
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Error: indexing with a numeric string might get you a completely separate type of Animal!</span>
<span class="token keyword">interface</span> <span class="token class-name">NotOkay</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> Animal<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Dog<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 示例二</span>
<span class="token keyword">interface</span> <span class="token class-name">NumberDictionary</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>    <span class="token comment">// ok, length is a number</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>      <span class="token comment">// error, the type of 'name' is not a subtype of the indexer</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果希望签名索引返回类型包含不同类型的话，可以借助联合类型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">NumberOrStringDictionary</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> number <span class="token operator">|</span> string<span class="token punctuation">;</span>
    length<span class="token operator">:</span> number<span class="token punctuation">;</span>    <span class="token comment">// ok, length is a number</span>
    name<span class="token operator">:</span> string<span class="token punctuation">;</span>      <span class="token comment">// ok, name is a string</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="class-type"><a href="#class-type" class="header-anchor">#</a> Class Type</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    currentTime<span class="token operator">:</span> Date<span class="token punctuation">;</span>
    <span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    currentTime<span class="token operator">:</span> Date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token operator">:</span> Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentTime <span class="token operator">=</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果接口中具有构造函数签名，并且一个类实现了这个接口，会出现报错，因为只有类的实例会被检查，而构造函数属于静态方法，不会被检查：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 出现报错</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> number<span class="token punctuation">,</span> minute<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">{</span>
    currentTime<span class="token operator">:</span> Date<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有以下两种方法可以解决上述问题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方式一</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> number<span class="token punctuation">,</span> minute<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> ClockInterface<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createClock</span><span class="token punctuation">(</span><span class="token parameter">ctor<span class="token operator">:</span> ClockConstructor<span class="token punctuation">,</span> hour<span class="token operator">:</span> number<span class="token punctuation">,</span> minute<span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> ClockInterface <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span>hour<span class="token punctuation">,</span> minute<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DigitalClock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;beep beep&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">AnalogClock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;tick tock&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> digital <span class="token operator">=</span> <span class="token function">createClock</span><span class="token punctuation">(</span>DigitalClock<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> analog <span class="token operator">=</span> <span class="token function">createClock</span><span class="token punctuation">(</span>AnalogClock<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方式二</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> number<span class="token punctuation">,</span> minute<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
  <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> Clock<span class="token operator">:</span> ClockConstructor <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;beep beep&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="extending-interfaces"><a href="#extending-interfaces" class="header-anchor">#</a> Extending Interfaces</h3> <p>一个接口可以扩展多个接口：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">PenStroke</span> <span class="token punctuation">{</span>
    penWidth<span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span><span class="token punctuation">,</span> PenStroke <span class="token punctuation">{</span>
    sideLength<span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> square <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Square<span class="token punctuation">;</span>
square<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">;</span>
square<span class="token punctuation">.</span>sideLength <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
square<span class="token punctuation">.</span>penWidth <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="hybrid-types"><a href="#hybrid-types" class="header-anchor">#</a> Hybrid Types</h3> <p>接口中的属性可以混合函数类型和对象类型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>start<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    interval<span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Counter <span class="token punctuation">{</span>
    <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">start<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Counter<span class="token punctuation">;</span>
    counter<span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
    counter<span class="token punctuation">.</span><span class="token function-variable function">reset</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">getCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">c</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="interfaces-extending-classes"><a href="#interfaces-extending-classes" class="header-anchor">#</a> Interfaces Extending Classes</h3> <p>接口可以扩展类，扩展类的同时会继承类的<code>private</code>和<code>protected</code>属性，如果类中有这两个属性，并且接口扩展了该类，这意味着这个接口只能由这个类及其子类去实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Control</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> state<span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SelectableControl</span> <span class="token keyword">extends</span> <span class="token class-name">Control</span> <span class="token punctuation">{</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Control</span> <span class="token keyword">implements</span> <span class="token class-name">SelectableControl</span> <span class="token punctuation">{</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TextBox</span> <span class="token keyword">extends</span> <span class="token class-name">Control</span> <span class="token punctuation">{</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Error: Property 'state' is missing in type 'Image'.</span>
<span class="token keyword">class</span> <span class="token class-name">Image</span> <span class="token keyword">implements</span> <span class="token class-name">SelectableControl</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> state<span class="token operator">:</span> any<span class="token punctuation">;</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Location</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="classes"><a href="#classes" class="header-anchor">#</a> Classes</h2> <h3 id="emascript-private-fields"><a href="#emascript-private-fields" class="header-anchor">#</a> EMAScript Private Fields</h3> <p>在TS 3.8中，<code>private</code>支持新的语法<code>#</code>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    #name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>theName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>#name<span class="token punctuation">;</span> <span class="token comment">// Property '#name' is not accessible outside class 'Animal' because it has a private identifier.</span>
</code></pre></div><h3 id="understanding-typescript-s-private"><a href="#understanding-typescript-s-private" class="header-anchor">#</a> Understanding TypeScript's <code>private</code></h3> <p>在TS中，类A和类B如果结构上一致，即有相同的属性方法，则认为两者是相容的。但是如果属性为<code>private</code>或<code>protected</code>，并且类A和类B不是父子关系，那么两者就是不相容的了：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>theName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Rhino</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">&quot;Rhino&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>theName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">&quot;Goat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> rhino <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rhino</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

animal <span class="token operator">=</span> rhino<span class="token punctuation">;</span>
animal <span class="token operator">=</span> employee<span class="token punctuation">;</span> <span class="token comment">// Error: 'Animal' and 'Employee' are not compatible</span>
</code></pre></div><h3 id="understanding-protected"><a href="#understanding-protected" class="header-anchor">#</a> Understanding <code>protected</code></h3> <p>构造函数也可以是<code>protected</code>，这意味着该类无法被外部实例化，但是继承它的子类可以通过<code>super()</code>调用：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span>theName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Employee can extend Person</span>
<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> department<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>department <span class="token operator">=</span> department<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">getElevatorPitch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and I work in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>department<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> howard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;Howard&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sales&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> john <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: The 'Person' constructor is protected</span>
</code></pre></div><h3 id="readonly-modifier"><a href="#readonly-modifier" class="header-anchor">#</a> Readonly modifier</h3> <p>类中构造函数参数也可以被<code>readonly</code>修饰，意味着该类包含该参数名的属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Octopus</span> <span class="token punctuation">{</span>
    <span class="token keyword">readonly</span> numberOfLegs<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> <span class="token keyword">readonly</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> octopus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Octopus</span><span class="token punctuation">(</span><span class="token string">&quot;octopus&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>octopus<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// &quot;octopus&quot;</span>
</code></pre></div><h3 id="accessors"><a href="#accessors" class="header-anchor">#</a> Accessors</h3> <p>通过<code>get</code>、<code>set</code>，可以做一些拦截功能：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> fullNameMaxLength <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _fullName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    <span class="token keyword">get</span> <span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_fullName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">set</span> <span class="token function">fullName</span><span class="token punctuation">(</span>newName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newName <span class="token operator">&amp;&amp;</span> newName<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> fullNameMaxLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;fullName has a max length of &quot;</span> <span class="token operator">+</span> fullNameMaxLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">this</span><span class="token punctuation">.</span>_fullName <span class="token operator">=</span> newName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
employee<span class="token punctuation">.</span>fullName <span class="token operator">=</span> <span class="token string">&quot;Bob Smith&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>employee<span class="token punctuation">.</span>fullName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span>fullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意事项：</p> <ul><li>使用accessors需要设置编译器输出ECMAScript5以上版本。</li> <li>如果只有<code>get</code>没有<code>set</code>，则默认为<code>readonly</code>。</li></ul> <h3 id="static-properties"><a href="#static-properties" class="header-anchor">#</a> Static Properties</h3> <p>通过<code>Classname.propertyname</code>的格式来调用：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Grid</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> origin <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span>point<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> xDist <span class="token operator">=</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span>x <span class="token operator">-</span> Grid<span class="token punctuation">.</span>origin<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> yDist <span class="token operator">=</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span>y <span class="token operator">-</span> Grid<span class="token punctuation">.</span>origin<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>xDist <span class="token operator">*</span> xDist <span class="token operator">+</span> yDist <span class="token operator">*</span> yDist<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">constructor</span> <span class="token punctuation">(</span><span class="token keyword">public</span> scale<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> grid1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Grid</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1x scale</span>
<span class="token keyword">let</span> grid2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Grid</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5x scale</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>grid1<span class="token punctuation">.</span><span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>grid2<span class="token punctuation">.</span><span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="abstract-classes"><a href="#abstract-classes" class="header-anchor">#</a> Abstract Classes</h3> <p>抽象类不可被实例化，但是其方法可能已包含实现细节。<code>abstract</code>关键字可以用于定义类以及类的方法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token function">makeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;roaming the earth...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>抽象方法不包含实现细节，其子类必须实现这些抽象方法。</p> <h3 id="advanced-techniques"><a href="#advanced-techniques" class="header-anchor">#</a> Advanced Techniques</h3> <p>可以将类直接赋给变量，该变量可以直接调用类的静态属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> standardGreeting <span class="token operator">=</span> <span class="token string">&quot;Hello, there&quot;</span><span class="token punctuation">;</span>
    greeting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> Greeter<span class="token punctuation">.</span>standardGreeting<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> greeter1<span class="token operator">:</span> Greeter<span class="token punctuation">;</span>
greeter1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeter1<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Hello, there&quot;</span>

<span class="token keyword">let</span> greeterMaker<span class="token operator">:</span> <span class="token keyword">typeof</span> Greeter <span class="token operator">=</span> Greeter<span class="token punctuation">;</span>
greeterMaker<span class="token punctuation">.</span>standardGreeting <span class="token operator">=</span> <span class="token string">&quot;Hey there!&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> greeter2<span class="token operator">:</span> Greeter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">greeterMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeter2<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Hey there!&quot;</span>
</code></pre></div><p>接口可以实现类：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Point3d</span> <span class="token keyword">extends</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    z<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> point3d<span class="token operator">:</span> Point3d <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> z<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h2> <p>函数类型中的参数可以标注名字，类型中的参数名字只是为了增强可读性，函数具体的实现中，参数名可以与类型中参数名不一致：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myAdd</span><span class="token operator">:</span> <span class="token punctuation">(</span>baseValue<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> increment<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">number</span> <span class="token operator">=</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>默认参数和可选参数不同，可选参数必须放到参数列表最后。</p> <h3 id="thisparameters"><a href="#thisparameters" class="header-anchor">#</a> <code>this</code>parameters</h3> <p>函数类型的第一个参数可以指定函数中<code>this</code>的类型，这并不是一个真实的参数，只是提供给TS作类型检查：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Card</span> <span class="token punctuation">{</span>
    suit<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    card<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Deck</span> <span class="token punctuation">{</span>
    suits<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    cards<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">createCardPicker</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Deck<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Card<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> deck<span class="token operator">:</span> Deck <span class="token operator">=</span> <span class="token punctuation">{</span>
    suits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clubs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    cards<span class="token operator">:</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// NOTE: The function now explicitly specifies that its callee must be of type Deck</span>
    <span class="token function-variable function">createCardPicker</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Deck<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>pickedCard <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token punctuation">{</span>suit<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token operator">:</span> pickedCard <span class="token operator">%</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> cardPicker <span class="token operator">=</span> deck<span class="token punctuation">.</span><span class="token function">createCardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pickedCard <span class="token operator">=</span> <span class="token function">cardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="overloads"><a href="#overloads" class="header-anchor">#</a> Overloads</h3> <p>函数重载可以有效利用TS的类型检查。</p> <h2 id="generics"><a href="#generics" class="header-anchor">#</a> Generics</h2> <p>泛型函数有两种调用方法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 方法一：指明类型</span>
<span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;myString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// type of output will be 'string'</span>

<span class="token comment">// 方法二：类型推断</span>
<span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token function">identity</span><span class="token punctuation">(</span><span class="token string">&quot;myString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// type of output will be 'string'</span>
</code></pre></div><h3 id="generic-types"><a href="#generic-types" class="header-anchor">#</a> Generic Types</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 放到接口函数中</span>
<span class="token keyword">interface</span> <span class="token class-name">GenericIdentityFn</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> myIdentity<span class="token operator">:</span> GenericIdentityFn <span class="token operator">=</span> identity<span class="token punctuation">;</span>

<span class="token comment">// 放到接口中</span>
<span class="token keyword">interface</span> <span class="token class-name">GenericIdentityFn<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> myIdentity<span class="token operator">:</span> GenericIdentityFn<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> identity<span class="token punctuation">;</span>
</code></pre></div><h3 id="generic-classes"><a href="#generic-classes" class="header-anchor">#</a> Generic Classes</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">GenericNumber<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    zeroValue<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
    <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myGenericNumber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericNumber<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myGenericNumber<span class="token punctuation">.</span>zeroValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
myGenericNumber<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>需要注意类中的静态成员无法使用泛型标注。</p> <h3 id="generic-constraints"><a href="#generic-constraints" class="header-anchor">#</a> Generic Constraints</h3> <p>有时候需要使用泛型约束，限定类型具有的属性特点，看下面例子：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">loggingIdentity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Error: T doesn't have .length</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们确定传入的类型一定会有<code>length</code>属性，但是TS并不知道，这里就会出现错误提示。因此，需要使用<code>extends</code>来指明该类型是具有<code>length</code>属性的：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Lengthwise</span> <span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">loggingIdentity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Lengthwise<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Now we know it has a .length property, so no more error</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以定义另一个类型参数，以此来确保代码中获取的属性都是存在于对象中的：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getProperty</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> d<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">getProperty</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// okay</span>
<span class="token function">getProperty</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error: Argument of type 'm' isn't assignable to 'a' | 'b' | 'c' | 'd'.</span>
</code></pre></div><p>在类的构造函数(静态成员)中引入泛型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>c<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 具备继承关系</span>
<span class="token keyword">class</span> <span class="token class-name">BeeKeeper</span> <span class="token punctuation">{</span>
    hasMask<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ZooKeeper</span> <span class="token punctuation">{</span>
    nametag<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    numLegs<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Bee</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    keeper<span class="token operator">:</span> BeeKeeper<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Lion</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    keeper<span class="token operator">:</span> ZooKeeper<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createInstance</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">A</span> <span class="token keyword">extends</span> Animal<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>c<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">A</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">createInstance</span><span class="token punctuation">(</span>Lion<span class="token punctuation">)</span><span class="token punctuation">.</span>keeper<span class="token punctuation">.</span>nametag<span class="token punctuation">;</span>  <span class="token comment">// typechecks!</span>
<span class="token function">createInstance</span><span class="token punctuation">(</span>Bee<span class="token punctuation">)</span><span class="token punctuation">.</span>keeper<span class="token punctuation">.</span>hasMask<span class="token punctuation">;</span>   <span class="token comment">// typechecks!</span>
</code></pre></div><h2 id="enums"><a href="#enums" class="header-anchor">#</a> Enums</h2> <h3 id="numeric-enums"><a href="#numeric-enums" class="header-anchor">#</a> Numeric enums</h3> <p>数值型枚举类型可以制定从哪个数开始递增：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>
    Up <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    Down<span class="token punctuation">,</span>
    Left<span class="token punctuation">,</span>
    Right<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果枚举元素是混合类型的，那么没有显示初始化的元素必须在前面或者紧跟数值型元素：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> <span class="token constant">E</span> <span class="token punctuation">{</span>
    <span class="token constant">A</span> <span class="token operator">=</span> <span class="token function">getSomeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token comment">// Error! Enum member must have initializer.</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="string-enums"><a href="#string-enums" class="header-anchor">#</a> String enums</h3> <p>字符串类型的枚举元素必须显式初始化：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>
    Up <span class="token operator">=</span> <span class="token string">&quot;UP&quot;</span><span class="token punctuation">,</span>
    Down <span class="token operator">=</span> <span class="token string">&quot;DOWN&quot;</span><span class="token punctuation">,</span>
    Left <span class="token operator">=</span> <span class="token string">&quot;LEFT&quot;</span><span class="token punctuation">,</span>
    Right <span class="token operator">=</span> <span class="token string">&quot;RIGHT&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="computed-and-constant-members"><a href="#computed-and-constant-members" class="header-anchor">#</a> Computed and constant members</h3> <p>满足以下任一条件的枚举成员属于常量：</p> <ul><li>作为枚举类型的第一个成员，并且没有显式初始化：</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// E.X is constant:</span>
<span class="token keyword">enum</span> <span class="token constant">E</span> <span class="token punctuation">{</span> <span class="token constant">X</span> <span class="token punctuation">}</span>
</code></pre></div><ul><li>没有显示初始化，并且前一元素属于数值型常量：</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// All enum members in 'E1' and 'E2' are constant.</span>

<span class="token keyword">enum</span> <span class="token constant">E1</span> <span class="token punctuation">{</span> <span class="token constant">X</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">,</span> <span class="token constant">Z</span> <span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token constant">E2</span> <span class="token punctuation">{</span>
    <span class="token constant">A</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token constant">C</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>使用常量枚举表达式初始化的成员，以下属于枚举常量表达式：
<ul><li>字符串或数值枚举表达式</li> <li>引用事先定义的常量枚举成员</li> <li>使用<code>+</code>、<code>-</code>、<code>～</code>任一元运算符的常量表达式</li> <li>使用<code>+</code>、<code>-</code>、<code>*</code>、<code>/</code>、<code>%</code>、<code>&lt;&lt;</code>、<code>&gt;&gt;</code>、<code>&gt;&gt;&gt;</code>、<code>&amp;</code>、<code>｜</code>、<code>^</code>任意二元运算符的常量表达式</li></ul></li></ul> <p>其余都是计算型枚举类</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> FileAccess <span class="token punctuation">{</span>
    <span class="token comment">// constant members</span>
    None<span class="token punctuation">,</span>
    Read    <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
    Write   <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
    ReadWrite  <span class="token operator">=</span> Read <span class="token operator">|</span> Write<span class="token punctuation">,</span>
    <span class="token comment">// computed member</span>
    <span class="token constant">G</span> <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">.</span>length
<span class="token punctuation">}</span>
</code></pre></div><h3 id="enums-at-runtime"><a href="#enums-at-runtime" class="header-anchor">#</a> Enums at runtime</h3> <p>枚举类型存在于运行时：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> <span class="token constant">E</span> <span class="token punctuation">{</span>
    <span class="token constant">X</span><span class="token punctuation">,</span> <span class="token constant">Y</span><span class="token punctuation">,</span> <span class="token constant">Z</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">X</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">.</span><span class="token constant">X</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Works, since 'E' has a property named 'X' which is a number.</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token constant">E</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="enums-at-compile-time"><a href="#enums-at-compile-time" class="header-anchor">#</a> Enums at compile time</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> LogLevel <span class="token punctuation">{</span>
    <span class="token constant">ERROR</span><span class="token punctuation">,</span> <span class="token constant">WARN</span><span class="token punctuation">,</span> <span class="token constant">INFO</span><span class="token punctuation">,</span> <span class="token constant">DEBUG</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * This is equivalent to:
 * type LogLevelStrings = 'ERROR' | 'WARN' | 'INFO' | 'DEBUG';
 */</span>
<span class="token keyword">type</span> <span class="token class-name">LogLevelStrings</span> <span class="token operator">=</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> LogLevel<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">printImportant</span><span class="token punctuation">(</span>key<span class="token operator">:</span> LogLevelStrings<span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> LogLevel<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> LogLevel<span class="token punctuation">.</span><span class="token constant">WARN</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Log level key is: '</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Log level value is: '</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Log level message is: '</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">printImportant</span><span class="token punctuation">(</span><span class="token string">'ERROR'</span><span class="token punctuation">,</span> <span class="token string">'This is a message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="reverse-mappings"><a href="#reverse-mappings" class="header-anchor">#</a> Reverse mappings</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> Enum <span class="token punctuation">{</span>
    <span class="token constant">A</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> Enum<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> nameOfA <span class="token operator">=</span> Enum<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &quot;A&quot;</span>

<span class="token comment">// ===&gt; 编译</span>

<span class="token keyword">var</span> Enum<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>Enum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Enum<span class="token punctuation">[</span>Enum<span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Enum <span class="token operator">||</span> <span class="token punctuation">(</span>Enum <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> Enum<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> nameOfA <span class="token operator">=</span> Enum<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &quot;A&quot;</span>
</code></pre></div><h3 id="const-enums"><a href="#const-enums" class="header-anchor">#</a> <code>const</code> enums</h3> <p><code>const</code>类型的枚举变量和普通枚举变量不同，它将会在编译期间转换成真实的数字：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token keyword">enum</span> Directions <span class="token punctuation">{</span>
    Up<span class="token punctuation">,</span>
    Down<span class="token punctuation">,</span>
    Left<span class="token punctuation">,</span>
    Right
<span class="token punctuation">}</span>

<span class="token keyword">let</span> directions <span class="token operator">=</span> <span class="token punctuation">[</span>Directions<span class="token punctuation">.</span>Up<span class="token punctuation">,</span> Directions<span class="token punctuation">.</span>Down<span class="token punctuation">,</span> Directions<span class="token punctuation">.</span>Left<span class="token punctuation">,</span> Directions<span class="token punctuation">.</span>Right<span class="token punctuation">]</span>

<span class="token comment">// ===&gt; 编译</span>
<span class="token keyword">var</span> directions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token comment">/* Up */</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token comment">/* Down */</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token comment">/* Left */</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token comment">/* Right */</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ambient-enums"><a href="#ambient-enums" class="header-anchor">#</a> Ambient enums</h3> <p><code>ambient</code>枚举变量和非<code>ambient</code>枚举变量区别在于，<code>ambiemt</code>枚举变量成员如果没有显式初始化，则始终会被认为是计算型，而非常量型。</p> <p><a href="https://stackoverflow.com/questions/28818849/how-do-the-different-enum-variants-work-in-typescript" target="_blank" rel="noopener noreferrer">参考阅读<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="type-inference"><a href="#type-inference" class="header-anchor">#</a> Type Inference</h2> <h2 id="type-compatibility"><a href="#type-compatibility" class="header-anchor">#</a> Type Compatibility</h2> <p>typescript中类型兼容是基于结构化类型，即考虑两者的类型是否一致，如下面例子所示，相同结构的接口和类型是兼容的：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Named</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> p<span class="token operator">:</span> Named<span class="token punctuation">;</span>
<span class="token comment">// OK, because of structural typing</span>
p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="starting-out"><a href="#starting-out" class="header-anchor">#</a> Starting out</h3> <p>在ts中，如果y满足和x一样的结构，那么y就可以赋值给x，即使y中有多余的成员：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Named</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x<span class="token operator">:</span> Named<span class="token punctuation">;</span>
<span class="token comment">// y's inferred type is { name: string; location: string; }</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> location<span class="token operator">:</span> <span class="token string">&quot;Seattle&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span>
</code></pre></div><h3 id="comparing-two-functions"><a href="#comparing-two-functions" class="header-anchor">#</a> Comparing two functions</h3> <p>ts中比较函数时仅比较参数列表，不会比较函数名：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">y</span> <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// OK</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><p>示例中，x中的每个参数，在y中都有类型与之相对的参数，因此x可以赋值给y，反之不行。之所以允许忽视掉一些参数，是因为在JS中，这种忽视部分参数的写法非常常见，例如<code>Array#forEach</code>，它接受的回调函数可以传入3个参数，而常常我们只会传入一个参数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Don't force these extra parameters</span>
items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Should be OK!</span>
items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="function-parameter-bivariance"><a href="#function-parameter-bivariance" class="header-anchor">#</a> Function Parameter Bivariance</h4> <h4 id="optional-parameters-and-rest-parameters"><a href="#optional-parameters-and-rest-parameters" class="header-anchor">#</a> Optional Parameters and Rest Parameters</h4> <h4 id="functions-with-overloads"><a href="#functions-with-overloads" class="header-anchor">#</a> Functions with overloads</h4> <h3 id="classes-2"><a href="#classes-2" class="header-anchor">#</a> Classes</h3> <p>比较类的对象时，只会比较类对象的非成员，静态成员和构造函数不会进行比较。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    feet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> numFeet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Size</span> <span class="token punctuation">{</span>
    feet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>numFeet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a<span class="token operator">:</span> Animal<span class="token punctuation">;</span>
<span class="token keyword">let</span> s<span class="token operator">:</span> Size<span class="token punctuation">;</span>

a <span class="token operator">=</span> s<span class="token punctuation">;</span>  <span class="token comment">// OK</span>
s <span class="token operator">=</span> a<span class="token punctuation">;</span>  <span class="token comment">// OK</span>
</code></pre></div><h4 id="private-and-protected-members-in-classes"><a href="#private-and-protected-members-in-classes" class="header-anchor">#</a> Private and protected members in classes</h4> <p>如果类a中有<code>private</code>类型的成员，那么类b必须也有相对应的<code>private</code>成员，而且需要继承自相同的父类，两者才能相容，对于<code>protected</code>也是如此。</p> <h3 id="generics-2"><a href="#generics-2" class="header-anchor">#</a> Generics</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Empty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

x <span class="token operator">=</span> y<span class="token punctuation">;</span>  <span class="token comment">// OK, because y matches structure of x</span>

<span class="token keyword">interface</span> <span class="token class-name">NotEmpty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> NotEmpty<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> NotEmpty<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

x <span class="token operator">=</span> y<span class="token punctuation">;</span>  <span class="token comment">// Error, because x and y are not compatible</span>
</code></pre></div><p>对于泛型，如果没有指定其类型参数，则会认为是<code>any</code>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">identity</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

identity <span class="token operator">=</span> reverse<span class="token punctuation">;</span>  <span class="token comment">// OK, because (x: any) =&gt; any matches (y: any) =&gt; any</span>
</code></pre></div><h2 id="advanced-types"><a href="#advanced-types" class="header-anchor">#</a> Advanced Types</h2> <h3 id="intersection-types"><a href="#intersection-types" class="header-anchor">#</a> Intersection Types</h3> <p>交叉类型经常用于mixins等概念：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">extend</span><span class="token generic class-name"><span class="token operator">&lt;</span>First<span class="token punctuation">,</span> Second<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>first<span class="token operator">:</span> First<span class="token punctuation">,</span> second<span class="token operator">:</span> Second<span class="token punctuation">)</span><span class="token operator">:</span> First <span class="token operator">&amp;</span> Second <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>First <span class="token operator">&amp;</span> Second<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> prop <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span>result <span class="token keyword">as</span> First<span class="token punctuation">)</span><span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> prop <span class="token keyword">in</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>second<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span>result <span class="token keyword">as</span> Second<span class="token punctuation">)</span><span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result <span class="token keyword">as</span> First <span class="token operator">&amp;</span> Second<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Loggable</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ConsoleLogger</span> <span class="token keyword">implements</span> <span class="token class-name">Loggable</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, I'm </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> jim <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Jim'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ConsoleLogger<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
jim<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jim<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="union-types"><a href="#union-types" class="header-anchor">#</a> Union Types</h3> <p>联合类型只能引用多个类型共有的成员：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Bird</span> <span class="token punctuation">{</span>
    <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Fish</span> <span class="token punctuation">{</span>
    <span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Fish <span class="token operator">|</span> Bird <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> pet <span class="token operator">=</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pet<span class="token punctuation">.</span><span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// okay</span>
pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// errors</span>
</code></pre></div><h3 id="type-guards-and-differentiaing-types"><a href="#type-guards-and-differentiaing-types" class="header-anchor">#</a> Type Guards and Differentiaing Types</h3> <h3 id="user-defined-type-guards"><a href="#user-defined-type-guards" class="header-anchor">#</a> User-Defined Type Guards</h3> <h4 id="using-type-predicates"><a href="#using-type-predicates" class="header-anchor">#</a> Using type predicates</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">isFish</span><span class="token punctuation">(</span>pet<span class="token operator">:</span> Fish <span class="token operator">|</span> Bird<span class="token punctuation">)</span><span class="token operator">:</span> pet <span class="token keyword">is</span> Fish <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>pet <span class="token keyword">as</span> Fish<span class="token punctuation">)</span><span class="token punctuation">.</span>swim <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFish</span><span class="token punctuation">(</span>pet<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>pet is Fish</code>就是type predicate。调用<code>isFish</code>时，typescript会缩小变量类型范围，推断出pet是Fish类型还是Bird类型。</p> <h4 id="using-the-in-operator"><a href="#using-the-in-operator" class="header-anchor">#</a> Using the in operator</h4> <p>使用<code>n in x</code>表达式同样可以缩小类型范围：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span>pet<span class="token operator">:</span> Fish <span class="token operator">|</span> Bird<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;swim&quot;</span> <span class="token keyword">in</span> pet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pet<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="typeof-type-guards"><a href="#typeof-type-guards" class="header-anchor">#</a> typeof type guards</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span>padding <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> padding <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected string or number, got '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="instanceof-type-guards"><a href="#instanceof-type-guards" class="header-anchor">#</a> instanceof type guards</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Padder</span> <span class="token punctuation">{</span>
  <span class="token function">getPaddingString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SpaceRepeatingPadder</span> <span class="token keyword">implements</span> <span class="token class-name">Padder</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> numSpaces<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">getPaddingString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>numSpaces <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">StringPadder</span> <span class="token keyword">implements</span> <span class="token class-name">Padder</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">getPaddingString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getRandomPadder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span>
    <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">SpaceRepeatingPadder</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">StringPadder</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Type is 'SpaceRepeatingPadder | StringPadder'</span>
<span class="token keyword">let</span> padder<span class="token operator">:</span> Padder <span class="token operator">=</span> <span class="token function">getRandomPadder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>padder <span class="token keyword">instanceof</span> <span class="token class-name">SpaceRepeatingPadder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  padder<span class="token punctuation">;</span> <span class="token comment">// type narrowed to 'SpaceRepeatingPadder'</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>padder <span class="token keyword">instanceof</span> <span class="token class-name">StringPadder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  padder<span class="token punctuation">;</span> <span class="token comment">// type narrowed to 'StringPadder'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nullable-types"><a href="#nullable-types" class="header-anchor">#</a> Nullable types</h3> <h3 id="optional-parameters-and-properties"><a href="#optional-parameters-and-properties" class="header-anchor">#</a> Optional parameters and properties</h3> <p>开启了<code>--strictNullChecks</code>之后可选参数自动添加<code>|undefined</code>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error, 'null' is not assignable to 'number | undefined'</span>
</code></pre></div><p>对于类中可选属性也是一样：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">C</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// error, 'undefined' is not assignable to 'number'</span>
c<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
c<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// error, 'null' is not assignable to 'number | undefined'</span>
</code></pre></div><h3 id="type-guards-and-type-assertions"><a href="#type-guards-and-type-assertions" class="header-anchor">#</a> Type guards and type assertions</h3> <p>移除<code>null</code>的类型守护示例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>sn<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sn <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> sn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 简化</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>sn<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> sn <span class="token operator">||</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当编译器无法消除<code>null</code>或者<code>undefined</code>时，例如一些嵌套函数，可以使用类型断言运算符进行手动移除：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">broken</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">postfix</span><span class="token punctuation">(</span>epithet<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.  the &quot;</span> <span class="token operator">+</span> epithet<span class="token punctuation">;</span> <span class="token comment">// error, 'name' is possibly null</span>
  <span class="token punctuation">}</span>
  name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">postfix</span><span class="token punctuation">(</span><span class="token string">&quot;great&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fixed</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">postfix</span><span class="token punctuation">(</span>epithet<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.  the &quot;</span> <span class="token operator">+</span> epithet<span class="token punctuation">;</span> <span class="token comment">// ok</span>
  <span class="token punctuation">}</span>
  name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">postfix</span><span class="token punctuation">(</span><span class="token string">&quot;great&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="type-aliases"><a href="#type-aliases" class="header-anchor">#</a> Type Aliases</h3> <p>类型别名可以为一种类型（如：基本类型、联合类型等）创建一个别名：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">NameResolver</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">NameOrResolver</span> <span class="token operator">=</span> Name <span class="token operator">|</span> NameResolver<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span>n<span class="token operator">:</span> NameOrResolver<span class="token punctuation">)</span><span class="token operator">:</span> Name <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>和接口一样，类型别名可以为泛型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Container<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//</span>
<span class="token keyword">type</span> <span class="token class-name">Tree<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  left<span class="token operator">:</span> Tree<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  right<span class="token operator">:</span> Tree<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">LinkedList<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> next<span class="token operator">:</span> LinkedList<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> people<span class="token operator">:</span> LinkedList<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> people<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
</code></pre></div><h3 id="interfaces-vs-type-aliases"><a href="#interfaces-vs-type-aliases" class="header-anchor">#</a> Interfaces vs. Type Aliases</h3> <p>和接口相比，类型别名不会创建一个新的名字。</p> <p>在高于2.7版本中，类型别名允许扩展创建一个新的交集类型，如：<code>type Cat = Animal &amp; { purrs: true }</code>。</p> <h3 id="string-literal-types"><a href="#string-literal-types" class="header-anchor">#</a> String Literal Types</h3> <h3 id="numeric-literal-types"><a href="#numeric-literal-types" class="header-anchor">#</a> Numeric Literal Types</h3> <h3 id="enum-member-types"><a href="#enum-member-types" class="header-anchor">#</a> Enum Member Types</h3> <h3 id="discriminated-unions"><a href="#discriminated-unions" class="header-anchor">#</a> Discriminated Unions</h3> <ul><li>拥有共通属性</li> <li>将多个类型联合起来的类型别名</li> <li>基于共通属性</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// #1</span>
<span class="token keyword">interface</span> <span class="token class-name">Square</span> <span class="token punctuation">{</span>
  kind<span class="token operator">:</span> <span class="token string">&quot;square&quot;</span><span class="token punctuation">;</span>
  size<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
  kind<span class="token operator">:</span> <span class="token string">&quot;rectangle&quot;</span><span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span>
  kind<span class="token operator">:</span> <span class="token string">&quot;circle&quot;</span><span class="token punctuation">;</span>
  radius<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// #2</span>
<span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span> Square <span class="token operator">|</span> Rectangle <span class="token operator">|</span> Circle<span class="token punctuation">;</span>

<span class="token comment">// #3</span>
<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span>s<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;square&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> s<span class="token punctuation">.</span>size <span class="token operator">*</span> s<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;rectangle&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> s<span class="token punctuation">.</span>height <span class="token operator">*</span> s<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;circle&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> s<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="exhaustiveness-checking"><a href="#exhaustiveness-checking" class="header-anchor">#</a> Exhaustiveness checking</h3> <p>有时候希望编译器告诉开发者没有考虑到覆盖所有类型的错误：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">assertNever</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unexpected object: &quot;</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span>s<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;square&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> s<span class="token punctuation">.</span>size <span class="token operator">*</span> s<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;rectangle&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> s<span class="token punctuation">.</span>height <span class="token operator">*</span> s<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;circle&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> s<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">assertNever</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error here if there are missing cases</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="polymorphic-this-types"><a href="#polymorphic-this-types" class="header-anchor">#</a> Polymorphic this types</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">BasicCalculator</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">protected</span> value<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">currentValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">add</span><span class="token punctuation">(</span>operand<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> operand<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">multiply</span><span class="token punctuation">(</span>operand<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">*=</span> operand<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ... other operations go here ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ScientificCalculator</span> <span class="token keyword">extends</span> <span class="token class-name">BasicCalculator</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ... other operations go here ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScientificCalculator</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">currentValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="index-types"><a href="#index-types" class="header-anchor">#</a> Index types</h3> <p>使用索引类型可以让编译器检查使用动态属性名的代码，例如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">pluck</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> propertyNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> propertyNames<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> o<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们希望能够检测传入propertyNames的属性是否存在于对象o中:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">pluck</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> propertyNames<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> propertyNames<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> o<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  manufacturer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  model<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  year<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> taxi<span class="token operator">:</span> Car <span class="token operator">=</span> <span class="token punctuation">{</span>
  manufacturer<span class="token operator">:</span> <span class="token string">&quot;Toyota&quot;</span><span class="token punctuation">,</span>
  model<span class="token operator">:</span> <span class="token string">&quot;Camry&quot;</span><span class="token punctuation">,</span>
  year<span class="token operator">:</span> <span class="token number">2014</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Manufacturer and model are both of type string,</span>
<span class="token comment">// so we can pluck them both into a typed string array</span>
<span class="token keyword">let</span> makeAndModel<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">pluck</span><span class="token punctuation">(</span>taxi<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;manufacturer&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;model&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// If we try to pluck model and year, we get an</span>
<span class="token comment">// array of a union type: (string | number)[]</span>
<span class="token keyword">let</span> modelYear <span class="token operator">=</span> <span class="token function">pluck</span><span class="token punctuation">(</span>taxi<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;model&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;year&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上述例子中使用了索引类型查询运算符<code>keyof</code>，<code>keyof T</code>将会获得<code>T</code>中属性构成的联合类型，例如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> carProps<span class="token operator">:</span> <span class="token keyword">keyof</span> Car<span class="token punctuation">;</span> <span class="token comment">// the union of ('manufacturer' | 'model' | 'year')</span>
</code></pre></div><h3 id="index-types-and-index-signatures"><a href="#index-types-and-index-signatures" class="header-anchor">#</a> Index types and index signatures</h3> <p>索引签名的参数类型必须是number或string类型。如果索引签名的索引为string类型，那么<code>keyof T</code>的结果是<code>string | number</code>，如果索引为number类型，那么<code>keyof T</code>的结果为<code>number</code>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Dictionary<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> keys<span class="token operator">:</span> <span class="token keyword">keyof</span> Dictionary<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>
<span class="token keyword">let</span> value<span class="token operator">:</span> Dictionary<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Dictionary<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> keys<span class="token operator">:</span> <span class="token keyword">keyof</span> Dictionary<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
<span class="token keyword">let</span> value<span class="token operator">:</span> Dictionary<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Error, Property 'foo' does not exist on type 'Dictionary&lt;number&gt;'.</span>
<span class="token keyword">let</span> value<span class="token operator">:</span> Dictionary<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
</code></pre></div><h3 id="mapped-types"><a href="#mapped-types" class="header-anchor">#</a> Mapped types</h3> <p>TS可以通过映射类型的方式基于旧的类型创建一个新的类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Readonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Record<span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>需要注意这是创建一个新的类型，而不是一个成员，如果要新增一个成员：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Use this:</span>
<span class="token keyword">type</span> <span class="token class-name">PartialWithNewMember<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> newMember<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span>

<span class="token comment">// **Do not** use the following!</span>
<span class="token comment">// This is an error!</span>
<span class="token keyword">type</span> <span class="token class-name">PartialWithNewMember<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  newMember<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="inference-from-mapped-types"><a href="#inference-from-mapped-types" class="header-anchor">#</a> Inference from mapped types</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">unproxify</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>t<span class="token operator">:</span> Proxify<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> k <span class="token keyword">in</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> originalProps <span class="token operator">=</span> <span class="token function">unproxify</span><span class="token punctuation">(</span>proxyProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="conditional-types"><a href="#conditional-types" class="header-anchor">#</a> Conditional Types</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">X</span> <span class="token operator">:</span> <span class="token constant">Y</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">f</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">boolean</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token boolean">true</span></span> <span class="token operator">?</span> <span class="token builtin">string</span> <span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token comment">// Type is 'string | number'</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果传入条件类型的泛型参数类型同样为泛型，那么无法确知推断出其类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  propA<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  propB<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">f</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Foo</span> <span class="token operator">?</span> <span class="token builtin">string</span> <span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">foo</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Has type 'U extends Foo ? string : number'</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// This assignment is allowed though!</span>
  <span class="token keyword">let</span> b<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>因为无法确切得知x的类型，那么f的执行结果可能为string或number。</p> <h3 id="distributive-conditional-types"><a href="#distributive-conditional-types" class="header-anchor">#</a> Distributive conditional types</h3> <p>如果传入给<code>T extends U ? X : Y</code>的参数类型是<code>A | B | C</code>，那么推断的结果则是：<code>(A extends U ? X : Y) | (B extends U ? X : Y) | (C extends U ? X : Y)</code>。</p> <p>分布条件类型常常用于过滤：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token comment">// Remove types from T that are assignable to U</span>
<span class="token keyword">type</span> <span class="token class-name">Filter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span> <span class="token comment">// Remove types from T that are not assignable to U</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T30</span></span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;b&quot; | &quot;d&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T31</span></span> <span class="token operator">=</span> Filter<span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;a&quot; | &quot;c&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T32</span></span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T33</span></span> <span class="token operator">=</span> Filter<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// () =&gt; void</span>

<span class="token keyword">type</span> <span class="token class-name">NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// Remove null and undefined from T</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T34</span></span> <span class="token operator">=</span> NonNullable<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T35</span></span> <span class="token operator">=</span> NonNullable<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | string[]</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">f1</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> y<span class="token operator">:</span> NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Ok</span>
  y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// Error</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">f2</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> y<span class="token operator">:</span> NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Ok</span>
  y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// Error</span>
  <span class="token keyword">let</span> s1<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// Error</span>
  <span class="token keyword">let</span> s2<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Ok</span>
<span class="token punctuation">}</span>
</code></pre></div><p>条件类型和映射类型可以结合在一起使用：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">FunctionPropertyNames<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span> <span class="token operator">?</span> <span class="token constant">K</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">FunctionProperties<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> FunctionPropertyNames<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">NonFunctionPropertyNames<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">NonFunctionProperties<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> NonFunctionPropertyNames<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Part</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  subparts<span class="token operator">:</span> Part<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">updatePart</span><span class="token punctuation">(</span>newName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T40</span></span> <span class="token operator">=</span> FunctionPropertyNames<span class="token operator">&lt;</span>Part<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;updatePart&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T41</span></span> <span class="token operator">=</span> NonFunctionPropertyNames<span class="token operator">&lt;</span>Part<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;id&quot; | &quot;name&quot; | &quot;subparts&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T42</span></span> <span class="token operator">=</span> FunctionProperties<span class="token operator">&lt;</span>Part<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// { updatePart(newName: string): void }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T43</span></span> <span class="token operator">=</span> NonFunctionProperties<span class="token operator">&lt;</span>Part<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// { id: number, name: string, subparts: Part[] }</span>
</code></pre></div><h3 id="types-inference-in-conditional-types"><a href="#types-inference-in-conditional-types" class="header-anchor">#</a> Types inference in conditional types</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Unpacked<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>infer <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">U</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span>infer <span class="token constant">U</span><span class="token operator">&gt;</span></span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T0</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T4</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// Promise&lt;string&gt;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T5</span></span> <span class="token operator">=</span> Unpacked<span class="token operator">&lt;</span>Unpacked<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
</code></pre></div><p>对不同变量的对象推断得到联合类型</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Foo<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> infer <span class="token constant">U</span><span class="token punctuation">;</span> b<span class="token operator">:</span> infer <span class="token constant">U</span> <span class="token punctuation">}</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T10</span></span> <span class="token operator">=</span> Foo<span class="token operator">&lt;</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> b<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T11</span></span> <span class="token operator">=</span> Foo<span class="token operator">&lt;</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> b<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>
</code></pre></div><p>对不同变量的对象推断得到相交类型</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Bar<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">{</span> <span class="token function-variable function">a</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> infer <span class="token constant">U</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> infer <span class="token constant">U</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span>
  <span class="token operator">?</span> <span class="token constant">U</span>
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T20</span></span> <span class="token operator">=</span> Bar<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token function-variable function">a</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T21</span></span> <span class="token operator">=</span> Bar<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token function-variable function">a</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string &amp; number</span>
</code></pre></div><p>函数重载时作用于最后一个函数签名</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T30</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> foo<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>
</code></pre></div><p><code>infer</code>不能用于类型参数</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span> infer <span class="token constant">R</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">;</span> <span class="token comment">// Error, not supported</span>
</code></pre></div><p>但可以通过下面方法实现相同效果</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">AnyFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> AnyFunction<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> infer <span class="token constant">R</span>
  <span class="token operator">?</span> <span class="token constant">R</span>
  <span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="predefined-conditional-types"><a href="#predefined-conditional-types" class="header-anchor">#</a> Predefined conditional types</h3> <ul><li><code>Exclude&lt;T, U&gt;</code> -- 从<code>T</code>中剔除可以赋值给<code>U</code>的类型。</li> <li><code>Extract&lt;T, U&gt;</code> -- 提取<code>T</code>中可以赋值给<code>U</code>的类型。</li> <li><code>NonNullable</code> -- 从<code>T</code>中剔除<code>null</code>和<code>undefined</code>。</li> <li><code>ReturnType</code> -- 获取函数返回值类型。</li> <li><code>InstanceType</code> -- 获取构造函数类型的实例类型。</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T00</span></span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;b&quot; | &quot;d&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T01</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;a&quot; | &quot;c&quot;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T04</span></span> <span class="token operator">=</span> NonNullable<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// string | number</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T10</span></span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// string</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T20</span></span> <span class="token operator">=</span> InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> <span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// C</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T21</span></span> <span class="token operator">=</span> InstanceType<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// any</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T22</span></span> <span class="token operator">=</span> InstanceType<span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// any</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T23</span></span> <span class="token operator">=</span> InstanceType<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// Error</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T24</span></span> <span class="token operator">=</span> InstanceType<span class="token operator">&lt;</span><span class="token builtin">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// Error</span>
</code></pre></div><h2 id="declaring-merging"><a href="#declaring-merging" class="header-anchor">#</a> Declaring Merging</h2> <h3 id="merging-interfaces"><a href="#merging-interfaces" class="header-anchor">#</a> Merging Interfaces</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Box</span> <span class="token punctuation">{</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Box</span> <span class="token punctuation">{</span>
  scale<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> box<span class="token operator">:</span> Box <span class="token operator">=</span> <span class="token punctuation">{</span> height<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> scale<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>接口中的非函数成员必须唯一，如果不唯一也必须对应类型一致。</p> <p>接口中存在相同名称的函数成员时就会形成重载，并且靠后声明的具有较高的优先级：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Cloner</span> <span class="token punctuation">{</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Animal<span class="token punctuation">)</span><span class="token operator">:</span> Animal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Cloner</span> <span class="token punctuation">{</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Sheep<span class="token punctuation">)</span><span class="token operator">:</span> Sheep<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Cloner</span> <span class="token punctuation">{</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Dog<span class="token punctuation">)</span><span class="token operator">:</span> Dog<span class="token punctuation">;</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Cat<span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// result</span>
<span class="token keyword">interface</span> <span class="token class-name">Cloner</span> <span class="token punctuation">{</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Dog<span class="token punctuation">)</span><span class="token operator">:</span> Dog<span class="token punctuation">;</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Cat<span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">;</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Sheep<span class="token punctuation">)</span><span class="token operator">:</span> Sheep<span class="token punctuation">;</span>
  <span class="token function">clone</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Animal<span class="token punctuation">)</span><span class="token operator">:</span> Animal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是，如果函数参数为单个字符串字面量类型（不是联合字面量类型），将会提高最高优先级：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Document</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> Element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Document</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLDivElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLSpanElement<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Document</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLCanvasElement<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// result</span>
<span class="token keyword">interface</span> <span class="token class-name">Document</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLCanvasElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLDivElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLSpanElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span>tagName<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> Element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="merging-namespaces"><a href="#merging-namespaces" class="header-anchor">#</a> Merging Namespaces</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">namespace</span> Animals <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Zebra</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> Animals <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Legged</span> <span class="token punctuation">{</span>
    numberOfLegs<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// is equivalent to</span>
<span class="token keyword">namespace</span> Animals <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Legged</span> <span class="token punctuation">{</span>
    numberOfLegs<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Zebra</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>未被export的变量在合并之后，只存在于原来的namespace中：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">namespace</span> Animal <span class="token punctuation">{</span>
  <span class="token keyword">let</span> haveMuscles <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">animalsHaveMuscles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> haveMuscles<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> Animal <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">doAnimalsHaveMuscles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> haveMuscles<span class="token punctuation">;</span> <span class="token comment">// Error, because haveMuscles is not accessible here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="merging-namespaces-with-classes-functions-and-enums"><a href="#merging-namespaces-with-classes-functions-and-enums" class="header-anchor">#</a> Merging Namespaces with Classes, Functions and Enums</h3> <h4 id="merging-namespaces-with-classes"><a href="#merging-namespaces-with-classes" class="header-anchor">#</a> Merging Namespaces with Classes</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Album</span> <span class="token punctuation">{</span>
  label<span class="token operator">:</span> Album<span class="token punctuation">.</span>AlbumLabel<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">namespace</span> Album <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AlbumLabel</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildLabel</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> buildLabel<span class="token punctuation">.</span>prefix <span class="token operator">+</span> name <span class="token operator">+</span> buildLabel<span class="token punctuation">.</span>suffix<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> buildLabel <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">let</span> suffix <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">let</span> prefix <span class="token operator">=</span> <span class="token string">&quot;Hello, &quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">buildLabel</span><span class="token punctuation">(</span><span class="token string">&quot;Sam Smith&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> Color <span class="token punctuation">{</span>
  red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  green <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
  blue <span class="token operator">=</span> <span class="token number">4</span>
<span class="token punctuation">}</span>

<span class="token keyword">namespace</span> Color <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mixColor</span><span class="token punctuation">(</span>colorName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>colorName <span class="token operator">==</span> <span class="token string">&quot;yellow&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Color<span class="token punctuation">.</span>red <span class="token operator">+</span> Color<span class="token punctuation">.</span>green<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>colorName <span class="token operator">==</span> <span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Color<span class="token punctuation">.</span>red <span class="token operator">+</span> Color<span class="token punctuation">.</span>green <span class="token operator">+</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>colorName <span class="token operator">==</span> <span class="token string">&quot;magenta&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Color<span class="token punctuation">.</span>red <span class="token operator">+</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>colorName <span class="token operator">==</span> <span class="token string">&quot;cyan&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Color<span class="token punctuation">.</span>green <span class="token operator">+</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="disallowed-merges"><a href="#disallowed-merges" class="header-anchor">#</a> Disallowed Merges</h3> <p>类无法和其他的类或者变量进行合并。</p> <h3 id="module-augmentation"><a href="#module-augmentation" class="header-anchor">#</a> Module Augmentation</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// observable.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// ... implementation left as an exercise for the reader ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// map.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./observable&quot;</span><span class="token punctuation">;</span>
Observable<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... another exercise for the reader</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>上述例子中，typescript编译器无法获知<code>Observable.prototype.map</code>的任何信息。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// observable.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// ... implementation left as an exercise for the reader ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// map.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./observable&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;./observable&quot;</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token generic-function"><span class="token function">map</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Observable<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">map</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... another exercise for the reader</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// consumer.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./observable&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./map&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> o<span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过module augmentation可以解决这个问题。</p> <p>module augmentation有两个限制：</p> <ul><li>无法在顶层增加新的声明，只能扩展已有声明</li> <li>默认导出无法被augmented</li></ul> <h3 id="global-augmentation"><a href="#global-augmentation" class="header-anchor">#</a> Global Augmentation</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// observable.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// ... still no implementation ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> global <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token function">toObservable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token builtin">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toObservable</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="decorators"><a href="#decorators" class="header-anchor">#</a> Decorators</h2> <p>使用decorator，需要在tsconfig.json中开启<code>experimentalDecorators</code>。</p> <h3 id="decorator-factories"><a href="#decorator-factories" class="header-anchor">#</a> Decorator Factories</h3> <h3 id="decorator-composition"><a href="#decorator-composition" class="header-anchor">#</a> Decorator Composition</h3> <ul><li>decorator表达式自顶向下执行</li> <li>表达式返回的结果自底向上执行</li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;f(): evaluated&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;f(): called&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;g(): evaluated&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;g(): called&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  @<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  @<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// result</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> evaluated
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> evaluated
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> called
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> called
</code></pre></div><h3 id="decorator-evaluation"><a href="#decorator-evaluation" class="header-anchor">#</a> Decorator Evaluation</h3> <h3 id="class-decorator"><a href="#class-decorator" class="header-anchor">#</a> Class Decorator</h3> <p>class decorator在类前声明，作用于类的构造函数。无法用于声明文件（例如<code>declare</code>类）。</p> <p>class decorator将在运行时作为函数被调用，类的构造函数作为其唯一的参数。</p> <p>如果class decorator有返回值，那么该返回值将替换掉原先的构造函数。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">sealed</span><span class="token punctuation">(</span><span class="token keyword">constructor</span><span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span><span class="token keyword">constructor</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span><span class="token keyword">constructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@sealed
<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  greeting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">classDecorator</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  <span class="token keyword">constructor</span><span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token keyword">extends</span></span> <span class="token keyword">constructor</span> <span class="token punctuation">{</span>
    newProperty <span class="token operator">=</span> <span class="token string">&quot;new property&quot;</span><span class="token punctuation">;</span>
    hello <span class="token operator">=</span> <span class="token string">&quot;override&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@classDecorator
<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  property <span class="token operator">=</span> <span class="token string">&quot;property&quot;</span><span class="token punctuation">;</span>
  hello<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>m<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hello <span class="token operator">=</span> m<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Greeter</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// { &quot;property&quot;: &quot;property&quot;, &quot;hello&quot;: &quot;override&quot;, &quot;newProperty&quot;: &quot;new property&quot; } </span>
</code></pre></div><h3 id="method-decorator"><a href="#method-decorator" class="header-anchor">#</a> Method Decorator</h3> <p>method decorator在类方法前声明。作用于方法的<code>Property Descriptor</code>，可以观察、修改、替换调用方法的定义。和class decorator一样，无法用于声明文件中。</p> <p>method decorator在运行时被调用，并接受三个参数：</p> <ul><li>对于静态方法，则是类的构造函数；对于实例方法，则是实例本身</li> <li>方法的名字</li> <li>方法的<code>Property Descriptor</code>，<strong>注意：如果目标环境低于ES5，那么该值为undefined</strong></li></ul> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">enumerable</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
    target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
    propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    descriptor<span class="token operator">:</span> PropertyDescriptor
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    descriptor<span class="token punctuation">.</span>enumerable <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  greeting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">enumerable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="accessor-decorators"><a href="#accessor-decorators" class="header-anchor">#</a> Accessor Decorators</h3> <p>accessor decorator在存取器前声明。同样作用于<code>Property Descritor</code>。</p> <p><strong>注意</strong>：typescript不允许同时对同一个成员的<code>get</code>、<code>set</code>使用decorator，并且accessor decorator必须书写于前面的存取器中。因为<code>Property Descriptor</code>中可以指定<code>get</code>、<code>set</code>。</p> <p>accessor decorator接受的参数和method decorator一致。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">configurable</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
    target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
    propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    descriptor<span class="token operator">:</span> PropertyDescriptor
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    descriptor<span class="token punctuation">.</span>configurable <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> _y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_y <span class="token operator">=</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">configurable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token keyword">get</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">configurable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token keyword">get</span> <span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="property-decorators"><a href="#property-decorators" class="header-anchor">#</a> Property Decorators</h3> <p>property decorator在类成员变量前声明。</p> <p>只接受两个参数，没有<code>Property Descriptor</code>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> formatMetadataKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;format&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">format</span><span class="token punctuation">(</span>formatString<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span>formatMetadataKey<span class="token punctuation">,</span> formatString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getFormat</span><span class="token punctuation">(</span>target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span>formatMetadataKey<span class="token punctuation">,</span> target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  @<span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, %s&quot;</span><span class="token punctuation">)</span>
  greeting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> formatString <span class="token operator">=</span> <span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> formatString<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="parameter-decorators"><a href="#parameter-decorators" class="header-anchor">#</a> Parameter Decorators</h3> <p>parameter decorator作用于方法参数。</p> <p>接受三个参数，第三个参数为该成员其所在参数列表中的序号。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> requiredMetadataKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;required&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">required</span><span class="token punctuation">(</span>
  target<span class="token operator">:</span> Object<span class="token punctuation">,</span>
  propertyKey<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">,</span>
  parameterIndex<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> existingRequiredParameters<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    Reflect<span class="token punctuation">.</span><span class="token function">getOwnMetadata</span><span class="token punctuation">(</span>requiredMetadataKey<span class="token punctuation">,</span> target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  existingRequiredParameters<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>parameterIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Reflect<span class="token punctuation">.</span><span class="token function">defineMetadata</span><span class="token punctuation">(</span>
    requiredMetadataKey<span class="token punctuation">,</span>
    existingRequiredParameters<span class="token punctuation">,</span>
    target<span class="token punctuation">,</span>
    propertyKey
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span>
  target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  propertyName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  descriptor<span class="token operator">:</span> TypedPropertyDescriptor<span class="token operator">&lt;</span><span class="token builtin">Function</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> method <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> requiredParameters<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">getOwnMetadata</span><span class="token punctuation">(</span>
      requiredMetadataKey<span class="token punctuation">,</span>
      target<span class="token punctuation">,</span>
      propertyName
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>requiredParameters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> parameterIndex <span class="token keyword">of</span> requiredParameters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>
          parameterIndex <span class="token operator">&gt;=</span> arguments<span class="token punctuation">.</span>length <span class="token operator">||</span>
          arguments<span class="token punctuation">[</span>parameterIndex<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">undefined</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Missing required argument.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">method</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  greeting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @validate
  <span class="token function">greet</span><span class="token punctuation">(</span>@required name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="metadata"><a href="#metadata" class="header-anchor">#</a> Metadata</h3> <p>使用reflect-metadata</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i reflect-metadata --save
</code></pre></div><p>开启装饰器：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;emitDecoratorMetadata&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Line</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _p0<span class="token operator">:</span> Point<span class="token punctuation">;</span>
  <span class="token keyword">private</span> _p1<span class="token operator">:</span> Point<span class="token punctuation">;</span>

  @validate
  <span class="token keyword">set</span> <span class="token function">p0</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_p0 <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">p0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_p0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @validate
  <span class="token keyword">set</span> <span class="token function">p1</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_p1 <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">p1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_p1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">validate</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  descriptor<span class="token operator">:</span> TypedPropertyDescriptor<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token keyword">set</span> <span class="token operator">=</span> descriptor<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">;</span>
  descriptor<span class="token punctuation">.</span><span class="token function-variable function">set</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">type</span> <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;design:type&quot;</span><span class="token punctuation">,</span> target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token keyword">type</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid type.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">set</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Line</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _p0<span class="token operator">:</span> Point<span class="token punctuation">;</span>
  <span class="token keyword">private</span> _p1<span class="token operator">:</span> Point<span class="token punctuation">;</span>

  @validate
  @Reflect<span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token string">&quot;design:type&quot;</span><span class="token punctuation">,</span> Point<span class="token punctuation">)</span>
  <span class="token keyword">set</span> <span class="token function">p0</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_p0 <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">p0</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_p0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @validate
  @Reflect<span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token string">&quot;design:type&quot;</span><span class="token punctuation">,</span> Point<span class="token punctuation">)</span>
  <span class="token keyword">set</span> <span class="token function">p1</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_p1 <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">p1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_p1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><a href="https://www.jianshu.com/p/653bce04db0b" target="_blank" rel="noopener noreferrer">JavaScript Reflect Metadata 详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="iterators-and-generators"><a href="#iterators-and-generators" class="header-anchor">#</a> Iterators and Generators</h2> <h3 id="iterables"><a href="#iterables" class="header-anchor">#</a> Iterables</h3> <p>如果一个对象实现了<code>Symbol.iterator</code>属性，则被认为是可迭代的，例如内置类型：<code>Array</code>、<code>Map</code>、<code>Set</code>、<code>String</code>、<code>Int32Array</code>、<code>Uint32Array</code>等都实现了该属性。<code>Symbol.iterator</code>函数返回一个可迭代的值。</p> <h3 id="for-of-statements"><a href="#for-of-statements" class="header-anchor">#</a> for..of statements</h3> <p>for of表达式用于可迭代对象上，会调用其<code>Symbol.iterator</code>属性。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> someArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> entry <span class="token keyword">of</span> someArray<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, &quot;string&quot;, false</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="for-of-vs-for-in-statements"><a href="#for-of-vs-for-in-statements" class="header-anchor">#</a> for..of vs. for..in statements</h4> <p>for of返回的是列表的值；for in返回的是列表的键。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0&quot;, &quot;1&quot;, &quot;2&quot;,</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;4&quot;, &quot;5&quot;, &quot;6&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>for in可用于任何对象，for of用于可迭代的对象。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> pets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Cat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dog&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hamster&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pets<span class="token punctuation">[</span><span class="token string">&quot;species&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;mammals&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> pet <span class="token keyword">in</span> pets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;species&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> pet <span class="token keyword">of</span> pets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Cat&quot;, &quot;Dog&quot;, &quot;Hamster&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="code-generation"><a href="#code-generation" class="header-anchor">#</a> Code generation</h4> <p>如果目标为ES5或者ES3，迭代器只能用于<code>Array</code>类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> num <span class="token keyword">of</span> numbers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// generated below</span>
<span class="token keyword">var</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> _i <span class="token operator">&lt;</span> numbers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> _i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> num <span class="token operator">=</span> numbers<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="jsx"><a href="#jsx" class="header-anchor">#</a> JSX</h2> <h3 id="basic-usage"><a href="#basic-usage" class="header-anchor">#</a> Basic usage</h3> <p>使用JSX的两个条件：</p> <ul><li>文件后缀名为<code>jsx</code></li> <li>开启<code>jsx</code>选项</li></ul> <p>TypsScript包含三种JSX模式：<code>preserve</code>、<code>react</code>、<code>react-native</code>。这些模式只在emit阶段有所区别，类型检查阶段不受影响。<code>preserve</code>模式会在输出文件时保留JSX部分，给其他转换器进行转换，例如babel。<code>react</code>模式emit <code>React.createElement</code>，输出后缀名变为<code>.js</code>。<code>react-native</code>模式和<code>preserve</code>类似，保留JSX部分，但是输出文件名后缀为<code>.js</code>。</p> <h3 id="the-as-operator"><a href="#the-as-operator" class="header-anchor">#</a> The as operator</h3> <p>使用TypeScript类型断言时，使用<code>as</code>运算符而不要使用尖括号。</p> <h3 id="type-checking"><a href="#type-checking" class="header-anchor">#</a> Type Checking</h3> <p>对于一个JSX表达式<code>&lt;expr /&gt;</code>，<code>expr</code>可能是一个原生DOM，也可能是个组件，在TypeScript中使用和React一样的方式区分两者：首字母为大写为组件，否则为原生DOM。区分两者有以下两个原因：</p> <ul><li>在React中，如果是原生DOM，则会转换为<code>React.createElement(&quot;div&quot;)</code>，而组件则会转换为<code>React.createElement(MyComponent)</code>。</li> <li>组件可以传递任意自定义属性，而原生则只能接收自有的属性。</li></ul> <h3 id="intrinsic-elements"><a href="#intrinsic-elements" class="header-anchor">#</a> Intrinsic elements</h3> <p>intrinsic elements会查找<code>JSX.IntrinsciElements</code>接口。如果该接口未被定义，intrinsic elements将不会进行类型检查。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">IntrinsicElements</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>foo <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token operator">&lt;</span>bar <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre></div><p>上述例子中，bar不存在于<code>JSX.IntrinsciElements</code>接口中，因此报错。</p> <h3 id="value-based-elements"><a href="#value-based-elements" class="header-anchor">#</a> Value-based elements</h3> <p>有两种方法定义value-based element：</p> <ul><li>Function Component</li> <li>Class Component</li></ul> <p>因为这两种value-based elements在JSX中难以分辨，TS将先按Function Component的方式进行解析，如果失败则按Class Component的方式进行解析，两者都失败则抛出错误。</p> <h4 id="function-component"><a href="#function-component" class="header-anchor">#</a> Function Component</h4> <p>因为Function Component就是JS函数，因此可以进行函数重载：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">ClickableProps</span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">HomeProps</span> <span class="token keyword">extends</span> <span class="token class-name">ClickableProps</span> <span class="token punctuation">{</span>
  home<span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SideProps</span> <span class="token keyword">extends</span> <span class="token class-name">ClickableProps</span> <span class="token punctuation">{</span>
  side<span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">MainButton</span><span class="token punctuation">(</span>prop<span class="token operator">:</span> HomeProps<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">MainButton</span><span class="token punctuation">(</span>prop<span class="token operator">:</span> SideProps<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="class-component"><a href="#class-component" class="header-anchor">#</a> Class Component</h4> <p>element instance type可被赋值于<code>JSX.ElementClass</code>，默认的<code>JSX.ElementClass</code>为<code>{}</code>，可以对其进行增强以限制类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">ElementClass</span> <span class="token punctuation">{</span>
    render<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">MyFactoryFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>MyComponent <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token operator">&lt;</span>MyFactoryFunction <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>

<span class="token keyword">class</span> <span class="token class-name">NotAValidComponent</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NotAValidFactoryFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>NotAValidComponent <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
<span class="token operator">&lt;</span>NotAValidFactoryFunction <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre></div><h3 id="attribute-type-checking"><a href="#attribute-type-checking" class="header-anchor">#</a> Attribute type checking</h3> <p>intrinsic elements的属性检查取决于<code>JSX.IntrinsciElements</code>的属性：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">IntrinsicElements</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token punctuation">{</span> bar<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// element attributes type for 'foo' is '{bar?: boolean}'</span>
<span class="token operator">&lt;</span>foo bar <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>value-based elements的属性检查较为复杂一些。取决于element instance type的属性，由<code>JSX.ElementAttributesProperty</code>决定。应当只定义一个属性，该属性名将被用于检查。如果<code>JSX.ElementAttributesProperty</code>未提供，则使用类构造函数或函数组件调用的第一个参数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">ElementAttributesProperty</span> <span class="token punctuation">{</span>
    props<span class="token punctuation">;</span> <span class="token comment">// specify the property name to use</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
  <span class="token comment">// specify the property on the element instance type</span>
  <span class="token class-name">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// element attributes type for 'MyComponent' is '{foo?: string}'</span>
<span class="token operator">&lt;</span>MyComponent foo<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>更多例子：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">IntrinsicElements</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token punctuation">{</span> requiredProp<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> optionalProp<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>foo requiredProp<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token operator">&lt;</span>foo requiredProp<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> optionalProp<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token operator">&lt;</span>foo <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error, requiredProp is missing</span>
<span class="token operator">&lt;</span>foo requiredProp<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error, requiredProp should be a string</span>
<span class="token operator">&lt;</span>foo requiredProp<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> unknownProp <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error, unknownProp does not exist</span>
<span class="token operator">&lt;</span>foo requiredProp<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> some<span class="token operator">-</span><span class="token builtin">unknown</span><span class="token operator">-</span>prop <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok, because 'some-unknown-prop' is not a valid identifier</span>
</code></pre></div><p>需要注意的是，如果属性名不是有效的JS标识符，例如<code>data-*</code>，将不会报错。</p> <p>此外，<code>JSX.IntrinsicElements</code>用于声明JSX框架所需的额外的属性，而不是组件props或者arguments，例如React中的<code>key</code>。<code>JSX.IntrinsciClassAttributes&lt;T&gt;</code>可以用于声明class components的额外属性。该泛型参数对应类的实例类型。在React中，用于<code>Ref&lt;T&gt;</code>的<code>ref</code>属性。</p> <p>扩展运算符可正常工作：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> props <span class="token operator">=</span> <span class="token punctuation">{</span> requiredProp<span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>foo <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>

<span class="token keyword">var</span> badProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>foo <span class="token punctuation">{</span><span class="token operator">...</span>badProps<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre></div><h3 id="children-type-checking"><a href="#children-type-checking" class="header-anchor">#</a> Children Type Checking</h3> <p>使用<code>JSX.ElementChildrenAttribute</code>定义children属性类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">{</span>
  <span class="token keyword">interface</span> <span class="token class-name">ElementChildrenAttribute</span> <span class="token punctuation">{</span>
    children<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// specify children name to use</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在React typings中定义其他类型的children：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">PropsType</span> <span class="token punctuation">{</span>
  children<span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element
  name<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>PropsType<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// OK</span>
<span class="token operator">&lt;</span>Component name<span class="token operator">=</span><span class="token string">&quot;foo&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Component<span class="token operator">&gt;</span>

<span class="token comment">// Error: children is of type JSX.Element not array of JSX.Element</span>
<span class="token operator">&lt;</span>Component name<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Component<span class="token operator">&gt;</span>

<span class="token comment">// Error: children is of type JSX.Element not array of JSX.Element or string.</span>
<span class="token operator">&lt;</span>Component name<span class="token operator">=</span><span class="token string">&quot;baz&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  World
<span class="token operator">&lt;</span><span class="token operator">/</span>Component<span class="token operator">&gt;</span>
</code></pre></div><h3 id="the-jsx-result-type"><a href="#the-jsx-result-type" class="header-anchor">#</a> The JSX result type</h3> <h3 id="embedding-expressions"><a href="#embedding-expressions" class="header-anchor">#</a> Embedding Expressions</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>JSX可以在<code>{}</code>中使用嵌套表达式。上述例子中会出现报错，因为string类型不能和number相除。</p> <h3 id="react-integration"><a href="#react-integration" class="header-anchor">#</a> React integration</h3> <p>在React中使用JSX应当使用React typings。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/// &lt;reference path=&quot;react.d.ts&quot; /&gt;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  foo<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>foo<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>MyComponent foo<span class="token operator">=</span><span class="token string">&quot;bar&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token operator">&lt;</span>MyComponent foo<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre></div><h3 id="factory-functions"><a href="#factory-functions" class="header-anchor">#</a> Factory Functions</h3> <p>factory functions是可配置的。可以通过<code>jsxFactory</code>命令或者内联<code>@jsx</code>编译注视对文件进行单独配置。例如：如果设置<code>jsxFactory</code>为<code>createElement</code>，<code>&lt;div /&gt;</code>将转换为<code>createElement(&quot;div&quot;)</code>，而不是<code>React.createElement(&quot;div&quot;)</code>。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> preact <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;preact&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* @jsx preact.h */</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token operator">&lt;</span>div <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">// emits as:</span>

<span class="token keyword">const</span> preact <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;preact&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> preact<span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>fatory的选择会影响JSX namespace的查找。如果fatory定义为<code>React.createElement</code>，则编译器会优先检查<code>React.JSX</code>，其次是全局JSX。</p> <h2 id="mixins"><a href="#mixins" class="header-anchor">#</a> Mixins</h2> <h3 id="mixin-sample"><a href="#mixin-sample" class="header-anchor">#</a> Mixin sample</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Disposable Mixin</span>
<span class="token keyword">class</span> <span class="token class-name">Disposable</span> <span class="token punctuation">{</span>
  isDisposed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isDisposed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Activatable Mixin</span>
<span class="token keyword">class</span> <span class="token class-name">Activatable</span> <span class="token punctuation">{</span>
  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token function">activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SmartObject</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isActive <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isDisposed<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token number">500</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">interact</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SmartObject</span> <span class="token keyword">extends</span> <span class="token class-name">Disposable</span><span class="token punctuation">,</span> Activatable <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">applyMixins</span><span class="token punctuation">(</span>SmartObject<span class="token punctuation">,</span> <span class="token punctuation">[</span>Disposable<span class="token punctuation">,</span> Activatable<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> smartObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SmartObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> smartObj<span class="token punctuation">.</span><span class="token function">interact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">////////////////////////////////////////</span>
<span class="token comment">// In your runtime library somewhere</span>
<span class="token comment">////////////////////////////////////////</span>

<span class="token keyword">function</span> <span class="token function">applyMixins</span><span class="token punctuation">(</span>derivedCtor<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> baseCtors<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  baseCtors<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>baseCtor <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>baseCtor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>name <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>
        derivedCtor<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span>
        name<span class="token punctuation">,</span>
        Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>baseCtor<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="understanding-the-sample"><a href="#understanding-the-sample" class="header-anchor">#</a> Understanding the sample</h3> <p>上述例子中并没有在class中extend，而是在interface中extend。因为声明合并，<code>SmartObject</code>interface将会被混入<code>SamrObject</code>类中。这意味着Disposable和Activatable存在于类型中，而不是具体实现。</p> <h2 id="modules"><a href="#modules" class="header-anchor">#</a> Modules</h2> <h3 id="export"><a href="#export" class="header-anchor">#</a> Export</h3> <h4 id="eporting-a-declaration"><a href="#eporting-a-declaration" class="header-anchor">#</a> Eporting a declaration</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// StringValidator.ts</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
  <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ZipCodeValidator.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StringValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./StringValidator&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> numberRegexp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[0-9]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
  <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="export-statements"><a href="#export-statements" class="header-anchor">#</a> Export statements</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token keyword">implements</span> <span class="token class-name">StringValidator</span> <span class="token punctuation">{</span>
  <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token keyword">as</span> mainValidator <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="re-exports"><a href="#re-exports" class="header-anchor">#</a> Re-exports</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ParseIntBasedZipCodeValidator</span> <span class="token punctuation">{</span>
  <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> s<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Export original validator but rename it</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token keyword">as</span> RegExpBasedZipCodeValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="import"><a href="#import" class="header-anchor">#</a> Import</h3> <h4 id="import-a-single-export-from-a-module"><a href="#import-a-single-export-from-a-module" class="header-anchor">#</a> Import a single export from a module</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// can also be renamed</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token keyword">as</span> <span class="token constant">ZCV</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">ZCV</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="import-the-entire-module-into-a-single-variable-and-use-it-to-access-the-module-exports"><a href="#import-the-entire-module-into-a-single-variable-and-use-it-to-access-the-module-exports" class="header-anchor">#</a> Import the entire module into a single variable, and use it to access the module exports</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> validator <span class="token keyword">from</span> <span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myValidator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">validator</span><span class="token punctuation">.</span><span class="token function">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="import-a-module-for-side-effects-only"><a href="#import-a-module-for-side-effects-only" class="header-anchor">#</a> Import a module for side-effects only</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">&quot;./my-module.js&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="importing-types"><a href="#importing-types" class="header-anchor">#</a> Importing Types</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Re-using the same import</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>APIResponseType<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./api&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Explicitly use import type</span>
<span class="token class-name"><span class="token keyword">import</span></span> <span class="token keyword">type</span> <span class="token punctuation">{</span>APIResponseType<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./api&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="default-exports"><a href="#default-exports" class="header-anchor">#</a> Default exports</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// export</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> $<span class="token operator">:</span> JQuery<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> $<span class="token punctuation">;</span>

<span class="token comment">// import</span>
<span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;button.continue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;Next Step...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="export-all-as-x"><a href="#export-all-as-x" class="header-anchor">#</a> Export all as x</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// export</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">as</span> utilities <span class="token keyword">from</span> <span class="token string">&quot;./utilities&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// import</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> utilities <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./index&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="export-and-import-require"><a href="#export-and-import-require" class="header-anchor">#</a> export = and import = require()</h3> <p>使用<code>export =</code>导出时，需要使用<code>import = require()</code>导入：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// export</span>
<span class="token keyword">let</span> numberRegexp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[0-9]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ZipCodeValidator</span> <span class="token punctuation">{</span>
  <span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> numberRegexp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token operator">=</span> ZipCodeValidator<span class="token punctuation">;</span>


<span class="token comment">// import</span>
<span class="token keyword">import</span> zip <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Some samples to try</span>
<span class="token keyword">let</span> strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;98052&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;101&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// Validators to use</span>
<span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">zip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Show whether each string passed each validator</span>
strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>s <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>s<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>validator<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&quot;matches&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;does not match&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="code-generation-for-modules"><a href="#code-generation-for-modules" class="header-anchor">#</a> Code Generation for Modules</h3> <p>编译器会根据module target生成合适的模块加载代码。</p> <p>export</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> m <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;mod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> t <span class="token operator">=</span> m<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>AMD</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;require&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exports&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./mod&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">require</span><span class="token punctuation">,</span> exports<span class="token punctuation">,</span> mod_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>CommonJS</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> mod_1 <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;./mod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>UMD</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">module</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> <span class="token keyword">module</span><span class="token punctuation">.</span>exports <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token keyword">require</span><span class="token punctuation">,</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">module</span><span class="token punctuation">.</span>exports <span class="token operator">=</span> v<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;require&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exports&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./mod&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">require</span><span class="token punctuation">,</span> exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> mod_1 <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;./mod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  exports<span class="token punctuation">.</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>System</p> <div class="language-ts extra-class"><pre class="language-ts"><code>System<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./mod&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>exports_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> mod_1<span class="token punctuation">;</span>
  <span class="token keyword">var</span> t<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    setters<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">function</span><span class="token punctuation">(</span>mod_1_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mod_1 <span class="token operator">=</span> mod_1_1<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">execute</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">exports_1</span><span class="token punctuation">(</span><span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> mod_1<span class="token punctuation">.</span>something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Native ES 2015 module</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> something <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./mod&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> t <span class="token operator">=</span> something <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="simple-example"><a href="#simple-example" class="header-anchor">#</a> Simple Example</h4> <h3 id="optional-module-loading-and-other-advanced-loading-scenarios"><a href="#optional-module-loading-and-other-advanced-loading-scenarios" class="header-anchor">#</a> Optional Module Loading and Other Advanced Loading Scenarios</h3> <p>如果导入的变量只用于类型检查，而没有用于表达式，那么该模块并不会被包含在emit</p> <p>之后的JS中。有时候需要根据条件动态加载模块：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token keyword">require</span><span class="token punctuation">(</span>moduleName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ZipCodeValidator <span class="token keyword">as</span> Zip <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>needZipValidation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ZipCodeValidator<span class="token operator">:</span> <span class="token keyword">typeof</span> Zip <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;./ZipCodeValidator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipCodeValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>validator<span class="token punctuation">.</span><span class="token function">isAcceptable</span><span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="working-with-other-js-libraries"><a href="#working-with-other-js-libraries" class="header-anchor">#</a> Working with Other JS Libraries</h3> <h4 id="ambient-modules"><a href="#ambient-modules" class="header-anchor">#</a> Ambient Modules</h4> <p>通过<code>module</code>关键字声明不同模块的类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;url&quot;</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Url</span> <span class="token punctuation">{</span>
    protocol<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    hostname<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    pathname<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>
    urlStr<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    parseQueryString<span class="token operator">?</span><span class="token punctuation">,</span>
    slashesDenoteHost<span class="token operator">?</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> Url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;path&quot;</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">normalize</span><span class="token punctuation">(</span>p<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token operator">...</span>paths<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">var</span> sep<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>导入相应的类型信息：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/// &lt;reference path=&quot;node.d.ts&quot;/&gt;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">URL</span> <span class="token keyword">from</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// import url = require(&quot;url&quot;) // 也可以这样导入</span>
<span class="token keyword">let</span> myUrl <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.typescriptlang.org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="wildcard-module-declarations"><a href="#wildcard-module-declarations" class="header-anchor">#</a> Wildcard module declarations</h4> <p>导入非js类型的文件：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;*!text&quot;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Some do it the other way around.</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">&quot;json!*&quot;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> fileContent <span class="token keyword">from</span> <span class="token string">&quot;./xyz.txt!text&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">&quot;json!http://example.com/data.json&quot;</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> fileContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="umd-modules"><a href="#umd-modules" class="header-anchor">#</a> UMD modules</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isPrime</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">as</span> <span class="token keyword">namespace</span> mathLib<span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> isPrime <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;math-lib&quot;</span><span class="token punctuation">;</span>
<span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ERROR: can't use the global definition from inside a module</span>
</code></pre></div><p>mathLib也可以在script中当作全局变量使用（A script is a file with no imports or exports)：</p> <div class="language-ts extra-class"><pre class="language-ts"><code>mathLib<span class="token punctuation">.</span><span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="guidance-for-structuring-moduels"><a href="#guidance-for-structuring-moduels" class="header-anchor">#</a> Guidance for structuring moduels</h3> <h4 id="if-you-re-only-exporting-a-single-class-or-functionm-use-export-default"><a href="#if-you-re-only-exporting-a-single-class-or-functionm-use-export-default" class="header-anchor">#</a> If you're only exporting a single class or functionm use export default</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// MyClass.ts</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// MyFunc.ts</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;thing&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Consumer.ts</span>
<span class="token keyword">import</span> t <span class="token keyword">from</span> <span class="token string">&quot;./MyClass&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> f <span class="token keyword">from</span> <span class="token string">&quot;./MyFunc&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="if-you-re-exporting-multiple-objects-put-them-all-at-top-level"><a href="#if-you-re-exporting-multiple-objects-put-them-all-at-top-level" class="header-anchor">#</a> If you're exporting multiple objects, put them all at top-level</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// MyThing.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Consumer.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SomeType<span class="token punctuation">,</span> someFunc <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./MyThings&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SomeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="use-the-namespace-import-pattern-if-you-re-importing-a-large-number-of-things"><a href="#use-the-namespace-import-pattern-if-you-re-importing-a-large-number-of-things" class="header-anchor">#</a> Use the namespace import pattern if you're importing a large number of things</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// MyLargeModule.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Tree</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Flower</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Consumer.ts</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> myLargeModule <span class="token keyword">from</span> <span class="token string">&quot;./MyLargeModule.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myLargeModule</span><span class="token punctuation">.</span><span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="re-export-to-extend"><a href="#re-export-to-extend" class="header-anchor">#</a> Re-export to extend</h3> <h3 id="do-not-use-namespaces-in-modules"><a href="#do-not-use-namespaces-in-modules" class="header-anchor">#</a> Do not use namespaces in modules</h3> <h3 id="red-flags"><a href="#red-flags" class="header-anchor">#</a> Red Flags</h3> <ul><li>顶级声明为<code>export namespace Foo { ... }</code>（移除<code>Foo</code>，将其中内容移动至顶级声明中）</li> <li>多个文件在顶级声明中包含相同的<code>export namespace Foo { ... }</code>。</li></ul> <h2 id="module-resolution"><a href="#module-resolution" class="header-anchor">#</a> Module Resolution</h2> <h3 id="module-resolution-strategies"><a href="#module-resolution-strategies" class="header-anchor">#</a> Module Resolution Strategies</h3> <h4 id="classic"><a href="#classic" class="header-anchor">#</a> Classic</h4> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./moduleB'</span>
</code></pre></div><p>would result in the following lookups:</p> <ol><li><code>/root/src/folder/moduleB.ts</code></li> <li><code>/root/src/folder/moduleB.d.ts</code></li></ol> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'moduleB'</span>
</code></pre></div><p>would result in the following lookups:</p> <ol><li><code>/root/src/folder/moduleB.ts</code></li> <li><code>/root/src/folder/moduleB.d.ts</code></li> <li><code>/root/src/moduleB.ts</code></li> <li><code>/root/src/moduleB.d.ts</code></li> <li><code>/root/moduleB.ts</code></li> <li><code>/root/moduleB.d.ts</code></li> <li><code>/moduleB.ts</code></li> <li><code>/moduleB.d.ts</code></li></ol> <h4 id="node"><a href="#node" class="header-anchor">#</a> Node</h4> <p>TypeScript will use field in <code>package.json</code> named <code>types</code> to mirror the purpose of <code>main</code>.</p> <p>Consider an import statement like <code>import { b } from './moduleB'</code> in file located at <code>/root/src/moduleA.ts</code>, it would results in the following lookups:</p> <ol><li><code>/root/src/moduleB.ts</code></li> <li><code>/root/src/moduleB.tsx</code></li> <li><code>/root/src/moduleB.d.ts</code></li> <li><code>/root/src/package.json</code></li> <li><code>/root/src/moduleB/index.ts</code></li> <li><code>/root/src/moduleB/index.tsx</code></li> <li><code>/root/src/moduleB/index.d.ts</code></li></ol> <p>Similaly, a non-relative import will resolve the module in <code>node_modules</code>.</p> <h3 id="additional-module-resolution-flags"><a href="#additional-module-resolution-flags" class="header-anchor">#</a> Additional module resolution flags</h3> <h4 id="base-url"><a href="#base-url" class="header-anchor">#</a> Base URL</h4> <p>All module imports with non-relative names are assumed to be relative to <code>baseUrl</code>.</p> <p>Value of baseUrl is determined as either:</p> <ul><li>command line argument</li> <li>property in <code>tsconfig.json</code></li></ul> <h4 id="path-mapping"><a href="#path-mapping" class="header-anchor">#</a> Path mapping</h4> <p>Sometimes, an import to a module <code>jquery</code> would be translated at runtime to <code>node_modules/jquery/dist/jquery.slim.min.js</code>. TypeScript compiler supports the declaration of such mappings using <code>paths</code> property in <code>tsconfig.json</code>.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token comment">// This must be specified if &quot;paths&quot; is.</span>
    <span class="token property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;jquery&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules/jquery/dist/jquery&quot;</span><span class="token punctuation">]</span> <span class="token comment">// This mapping is relative to &quot;baseUrl&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notice that <code>paths</code> are resolved relative to <code>baseUrl</code>. When setting <code>baseUrl</code> to <code>./src</code>, then jquery should be mapped to <code>../node_modules/jquery/dist/jquery</code>.</p> <p>Some sophisticated use case in handbook. <a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html#path-mapping" target="_blank" rel="noopener noreferrer">path mapping<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h4 id="virtual-directories-with-rootdirs"><a href="#virtual-directories-with-rootdirs" class="header-anchor">#</a> Virtual Directories with rootDirs</h4> <h3 id="tracing-module-resolution"><a href="#tracing-module-resolution" class="header-anchor">#</a> Tracing module resolution</h3> <p>Enabling the compiler module resolution tracing using <code>--traceResolution</code> provides insight int what happened during the module resolution process, which make easier to diagnose why a module is not resolved.</p> <h3 id="using-noresolve"><a href="#using-noresolve" class="header-anchor">#</a> Using --noResolve</h3> <p>The <code>--noResolve</code> compiler options instructs the compiler not to add any files to the compilation that were not passed on the command line.</p> <div class="language-ts extra-class"><pre class="language-ts"><code>tsc app<span class="token punctuation">.</span>ts moduleA<span class="token punctuation">.</span>ts <span class="token operator">--</span>noResolve

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">A</span> <span class="token keyword">from</span> <span class="token string">&quot;moduleA&quot;</span><span class="token punctuation">;</span> <span class="token comment">// OK, 'moduleA' passed on the command-line</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">B</span> <span class="token keyword">from</span> <span class="token string">&quot;moduleB&quot;</span><span class="token punctuation">;</span> <span class="token comment">// Error TS2307: Cannot find module 'moduleB'.</span>
</code></pre></div><h3 id="common-question"><a href="#common-question" class="header-anchor">#</a> Common Question</h3> <h4 id="why-does-a-module-in-the-exlcude-list-still-get-picked-up-by-the-compiler"><a href="#why-does-a-module-in-the-exlcude-list-still-get-picked-up-by-the-compiler" class="header-anchor">#</a> why does a module in the exlcude list still get picked up by the compiler</h4> <p><code>exclude</code> will tell TypeScript not to pick up some files to compile, however if the compiler identified a file as a target of a module import, it will be included.</p> <p><a href="/Web2/[https://jkchao.github.io/typescript-book-chinese/faqs/tsconfig-behavior.html#tsconfig-json-的行为](https://jkchao.github.io/typescript-book-chinese/faqs/tsconfig-behavior.html#tsconfig-json-的行为)">tsconfig.json的行为</a></p> <h2 id="namespaces"><a href="#namespaces" class="header-anchor">#</a> Namespaces</h2> <p>TODO</p> <h2 id="namespaces-and-modules"><a href="#namespaces-and-modules" class="header-anchor">#</a> Namespaces and Modules</h2> <h3 id="using-modules"><a href="#using-modules" class="header-anchor">#</a> Using Modules</h3> <p>Modules can contain both code and declarations.</p> <p>We recommended modules over namespaces in modern code.</p> <h3 id="using-namespaces"><a href="#using-namespaces" class="header-anchor">#</a> Using Namespaces</h3> <p>Unlike modules, they can span multiple files, and can be concatenated using <code>--outFile</code>.</p> <h3 id="pitfalls-of-namespaces-and-modules"><a href="#pitfalls-of-namespaces-and-modules" class="header-anchor">#</a> Pitfalls of Namespaces and Modules</h3> <p>A common mistake is to try to use the <code>/// &lt;refernce ... /&gt;</code> syntax to refer to a module file, rather than using <code>import</code> statement.</p> <p>Because the consumer of a module decides what name to assign it, there's no need to proactively wrap up the exported symbols in a namespace.</p> <h2 id="symbol"><a href="#symbol" class="header-anchor">#</a> Symbol</h2> <h3 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h3> <p><code>symbol</code> is a primitive data type.</p> <p><code>symbol</code> values are created by calling the <code>Symbol</code> constructor.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>symbol</code>  is immutable and unique.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> sym2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> sym3 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

sym2 <span class="token operator">===</span> sym3<span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p><code>symbol</code> can be used as keys for object properties.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>sym<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;value&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>sym<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;value&quot;</span>
</code></pre></div><p><code>symbol</code> can also be combined with computed property declarations to declare object properties and class members.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> getClassNameSymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>getClassNameSymbol<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">C</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> className <span class="token operator">=</span> c<span class="token punctuation">[</span>getClassNameSymbol<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;C&quot;</span>
</code></pre></div><h3 id="well-known-built-in-symbols"><a href="#well-known-built-in-symbols" class="header-anchor">#</a> Well-known Built-in Symbols</h3> <h4 id="symbol-hasinstance"><a href="#symbol-hasinstance" class="header-anchor">#</a> Symbol.hasInstance</h4> <p>Called by semantics of the instanceof operator.</p> <h4 id="symbol-isconcatspreadable"><a href="#symbol-isconcatspreadable" class="header-anchor">#</a> Symbol.isConcatSpreadable</h4> <h4 id="symbol-iterator"><a href="#symbol-iterator" class="header-anchor">#</a> Symbol.iterator</h4> <p>Called by the semantics of the for-of statement.</p> <h4 id="symbol-match"><a href="#symbol-match" class="header-anchor">#</a> Symbol.match</h4> <p>Called by the <code>String.prototype.match</code> method.</p> <h4 id="symbol-replace"><a href="#symbol-replace" class="header-anchor">#</a> Symbol.replace</h4> <p>Called by the <code>String.prototype.replace</code> method.</p> <h4 id="symbol-search"><a href="#symbol-search" class="header-anchor">#</a> Symbol.search</h4> <p>Called by the <code>String.prototype.search</code> method.</p> <h4 id="symbol-species"><a href="#symbol-species" class="header-anchor">#</a> Symbol.species</h4> <h4 id="symbol-split"><a href="#symbol-split" class="header-anchor">#</a> Symbol.split</h4> <p>Called by <code>String.prototype.split</code> method.</p> <h4 id="symbol-toprimitive"><a href="#symbol-toprimitive" class="header-anchor">#</a> Symbol.toPrimitive</h4> <p>Called by <code>ToPrimitive</code> abstract operation.</p> <h4 id="symbol-tostringtag"><a href="#symbol-tostringtag" class="header-anchor">#</a> Symbol.toStringTag</h4> <p>Called by the built-in method <code>Object.prototype.toString</code>.</p> <h4 id="symbol-unscopables"><a href="#symbol-unscopables" class="header-anchor">#</a> Symbol.unscopables</h4> <h2 id="triple-slash-directives"><a href="#triple-slash-directives" class="header-anchor">#</a> Triple-Slash Directives</h2> <p>Triple-slash directives are <strong>only</strong> valid at the top of their containing file.</p> <h3 id="reference-path"><a href="#reference-path" class="header-anchor">#</a> /// &lt;reference path=&quot;...&quot; /&gt;</h3> <p>Triple-slash references instruct the compiler to include additional files in the compilation process.</p> <p>The process starts with a set of root files, these are the file names specified on the command-line or in the <code>&quot;files&quot;</code> list in the <code>tsconfig.json</code> file. Before a file is added to the list, all triple-slash references in it are processed, and their tartgets included. Triple-slash references are resolved in a depth first manner.</p> <p>A triple-slash reference path is resolved relative to the containing file, if unrooted.</p> <p>If the compiler flag <code>--noResolve</code> is specified, triple-slash referenes are ignored.</p> <h3 id="reference-types"><a href="#reference-types" class="header-anchor">#</a> /// &lt;reference types=&quot;...&quot; /&gt;</h3> <p>For example, including <code>/// \&lt;reference types=&quot;node&quot; /&gt;</code> in a declaration file declares that this file uses names declared in <code>@types/node/index.d.ts</code>; and thus, this package needs to be included in the compilation along with the declaration file.</p> <p>For declaring a dependency on an <code>@types</code> package in a <code>.ts</code> file, use <code>--types</code> on the command line or in your <code>tsconfig.json</code> instead.</p> <h3 id="reference-lib"><a href="#reference-lib" class="header-anchor">#</a> /// &lt;reference lib=&quot;...&quot; /&gt;</h3> <p>This directive allows a file to explicitly include an existing built-in lib file.</p> <p>Built-in lib files are referenced in the same fashion as the <code>&quot;lib&quot;</code> compiler option in tsconfig.json (e.g. use <code>lib=&quot;es2015&quot;</code> and not <code>lib=&quot;lib.es2015.d.ts&quot;</code>, etc).</p> <h3 id="reference-no-default-lib-true"><a href="#reference-no-default-lib-true" class="header-anchor">#</a> /// &lt;reference no-default-lib=&quot;true&quot; /&gt;</h3> <p>This directive instructs the compiler to not include the default library (i.e. <code>lib.d.ts</code>) in the compilation. The impact here is similar to passing <code>--noLib</code> on the command line.</p> <p>Also note that when passing <code>--skipDefaultLibCheck</code>, the compiler will only skip checking files with <code>/// \&lt;reference no-default-lib=&quot;true&quot; \&gt;</code>.</p> <h3 id="amd-module"><a href="#amd-module" class="header-anchor">#</a> /// &lt;amd-module /&gt;</h3> <p>By default AMD modules are generated anonymous. This can lead to problems when other tools are used to process the resulting modules, such as bundlers.</p> <p>The <code>amd-module</code> directive allows passing an optional module name to the compiler.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/// &lt;amd-module name=&quot;NamedModule&quot; /&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Will result in assigning the name <code>NamedModule</code> to the module as part of calling the AMD <code>define</code>:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&quot;NamedModule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;require&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exports&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">require</span><span class="token punctuation">,</span> exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant">C</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  exports<span class="token punctuation">.</span><span class="token constant">C</span> <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="type-compatibility-2"><a href="#type-compatibility-2" class="header-anchor">#</a> Type Compatibility</h2> <h3 id="introduction-2"><a href="#introduction-2" class="header-anchor">#</a> Introduction</h3> <p>Type compatibility in TypeScript is based on structural subtyping. Structural typing is a way of relating types based soley on their members.</p> <h3 id="a-note-on-soundess"><a href="#a-note-on-soundess" class="header-anchor">#</a> A Note on Soundess</h3> <p>TypeScript’s type system allows certain operations that can’t be known at compile-time to be safe. When a type system has this property, it is said to not be “sound”.</p> <h3 id="starting-out-2"><a href="#starting-out-2" class="header-anchor">#</a> Starting out</h3> <p>The basic rule for TypeScript’s structural type system is that <code>x</code> is compatible with <code>y</code> if <code>y</code> has at least the same members as <code>x</code>.</p> <h3 id="comparing-two-functions-2"><a href="#comparing-two-functions-2" class="header-anchor">#</a> Comparing two functions</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">y</span> <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// OK</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Error</span>
</code></pre></div><p>To check if <code>x</code> is assignable to <code>y</code>, we first look at the parameter list. Each parameter in <code>x</code> must have a corresponding parameter in <code>y</code> with a compatible type.</p> <p>You may be wondering why we allow ‘discarding’ parameters like in the example <code>y = x</code>. The reason for this assignment to be allowed is that ignoring extra function parameters is actually quite common in JavaScript. For example, <code>Array#forEach</code> provides three parameters to the callback function: the array element, its index, and the containing array. Nevertheless, it’s very useful to provide a callback that only uses the first parameter.</p> <p>Now let’s look at how return types are treated, using two functions that differ only by their return type:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;Alice&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">y</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> location<span class="token operator">:</span> <span class="token string">&quot;Seattle&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// OK</span>
y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// Error, because x() lacks a location property</span>
</code></pre></div><p>The type system enforces that the source function’s return type be a subtype of the target type’s return type.</p> <h3 id="function-parameter-bivaraince"><a href="#function-parameter-bivaraince" class="header-anchor">#</a> Function Parameter Bivaraince</h3> <p>When comparing the types of function parameters, assignment succeeds if either the source parameter is assignable to the target parameter, or vice versa.</p> <p>You can have TypeScript raise errors when this happens via the compiler flag <code>strictFunctionTypes</code>.</p> <h3 id="optional-parameters-and-rest-parameters-2"><a href="#optional-parameters-and-rest-parameters-2" class="header-anchor">#</a> Optional Parameters and Rest Parameters</h3> <p>When comparing functions for compatibility, optional and required parameters are interchangeable.</p> <h3 id="functions-with-overloads-2"><a href="#functions-with-overloads-2" class="header-anchor">#</a> Functions with overloads</h3> <p>When a function has overloads, each overload in the source type must be matched by a compatible signature on the target type. This ensures that the target function can be called in all the same situations as the source function.</p> <h3 id="enums-2"><a href="#enums-2" class="header-anchor">#</a> Enums</h3> <p>Enums are compatible with numbers, and numbers are compatible with enums. Enum values from different enum types are considered incompatible.</p> <h3 id="classes-3"><a href="#classes-3" class="header-anchor">#</a> Classes</h3> <p>Classes work similarly to object literal types and interfaces with one exception: they have both a static and an instance type. When comparing two objects of a class type, only members of the instance are compared. Static members and constructors do not affect compatibility.</p> <h3 id="private-and-protected-members-in-classes-2"><a href="#private-and-protected-members-in-classes-2" class="header-anchor">#</a> Private and protected members in classes</h3> <p>Private and protected members in a class affect their compatibility. When an instance of a class is checked for compatibility, if the target type contains a private member, then the source type must also contain a private member that originated from the same class. Likewise, the same applies for an instance with a protected member. This allows a class to be assignment compatible with its super class, but <em>not</em> with classes from a different inheritance hierarchy which otherwise have the same shape.</p> <h3 id="generics-3"><a href="#generics-3" class="header-anchor">#</a> Generics</h3> <p>Because TypeScript is a structural type system, type parameters only affect the resulting type when consumed as part of the type of a member. For example,</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Empty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// OK, because y matches structure of x</span>
</code></pre></div><p>In the above, <code>x</code> and <code>y</code> are compatible because their structures do not use the type argument in a differentiating way. Changing this example by adding a member to <code>Empty</code> shows how this works:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">NotEmpty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> NotEmpty<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span> NotEmpty<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Error, because x and y are not compatible</span>
</code></pre></div><p>For generic types that do not have their type arguments specified, compatibility is checked by specifying <code>any</code> in place of all unspecified type arguments. For example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">identity</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

identity <span class="token operator">=</span> reverse<span class="token punctuation">;</span> <span class="token comment">// OK, because (x: any) =&gt; any matches (y: any) =&gt; any</span>
</code></pre></div><h2 id="type-inference-2"><a href="#type-inference-2" class="header-anchor">#</a> Type Inference</h2> <h3 id="best-common-type"><a href="#best-common-type" class="header-anchor">#</a> Best common type</h3> <p>Because the best common type has to be chosen from the provided candidate types, there are some cases where types share a common structure, but no one type is the super type of all candidate types. For example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> zoo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Rhino</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Elephant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Snake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Ideally, we may want <code>zoo</code> to be inferred as an <code>Animal[]</code>, but because there is no object that is strictly of type <code>Animal</code> in the array, we make no inference about the array element type. To correct this, instead explicitly provide the type when no one type is a super type of all other candidates:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> zoo<span class="token operator">:</span> Animal<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Rhino</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Elephant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Snake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>When no best common type is found, the resulting inference is the union array type, <code>(Rhino | Elephant | Snake)[]</code>.</p> <h3 id="contextual-typing"><a href="#contextual-typing" class="header-anchor">#</a> Contextual Typing</h3> <p>Type inference also works in “the other direction” in some cases in TypeScript. This is known as “contextual typing”. Contextual typing occurs when the type of an expression is implied by its location. For example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>mouseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mouseEvent<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt;- OK</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mouseEvent<span class="token punctuation">.</span>kangaroo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt;- Error!</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Here, the TypeScript type checker used the type of the <code>Window.onmousedown</code> function to infer the type of the function expression on the right hand side of the assignment. When it did so, it was able to infer the <a href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent" target="_blank" rel="noopener noreferrer">type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> of the <code>mouseEvent</code> parameter, which does contain a <code>button</code> property, but not a <code>kangaroo</code> property.</p> <p>The contextual type also acts as a candidate type in best common type. For example:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">createZoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Animal<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Rhino</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Elephant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Snake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this example, best common type has a set of four candidates: <code>Animal</code>, <code>Rhino</code>, <code>Elephant</code>, and <code>Snake</code>. Of these, <code>Animal</code> can be chosen by the best common type algorithm.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.750feb0e.js" defer></script><script src="/assets/js/2.51f79b28.js" defer></script><script src="/assets/js/105.6a8045bd.js" defer></script><script src="/assets/js/10.c677f95a.js" defer></script>
  </body>
</html>
